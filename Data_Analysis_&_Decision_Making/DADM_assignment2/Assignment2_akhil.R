#==========================================================================
# Assignment 2 DADM 
# Akhil Patil 
# RUID : 190004529
#==========================================================================


#==============================================================================================================

                          ########################## Q1 ##########################

#==============================================================================================================

# Loading Data 
DefaultCredit <- read.csv("D:/Downloads/DefaultCredit.csv")

colnames(DefaultCredit)
# [1] "X"   "X1"  "X2"  "X3"  "X4"  "X5"  "X6"  "X7"  "X8"  "X9"  "X10" "X11" "X12" "X13" "X14" "X15" "X16" "X17" "X18"
# [20] "X19" "X20" "X21" "X22" "X23" "Y" 

#data(DefaultCredit)

str(DefaultCredit)
# 'data.frame':	30001 obs. of  25 variables:
#   $ X  : Factor w/ 30001 levels "1","10","100",..: 30001 1 11112 22223 23335 24446 25557 26668 27779 28890 ...
# $ X1 : Factor w/ 82 levels "10000","100000",..: 82 14 5 81 48 48 48 49 2 7 ...
# $ X2 : Factor w/ 3 levels "1","2","SEX": 3 2 2 2 2 1 1 1 2 2 ...
# $ X3 : Factor w/ 8 levels "0","1","2","3",..: 8 3 3 3 3 3 2 2 3 4 ...
# $ X4 : Factor w/ 5 levels "0","1","2","3",..: 5 2 3 3 2 2 3 3 3 2 ...
# $ X5 : Factor w/ 57 levels "21","22","23",..: 57 4 6 14 17 37 17 9 3 8 ...
# $ X6 : Factor w/ 12 levels "-1","-2","0",..: 12 5 1 3 3 1 3 3 3 3 ...
# $ X7 : Factor w/ 12 levels "-1","-2","0",..: 12 5 5 3 3 3 3 3 1 3 ...
# $ X8 : Factor w/ 12 levels "-1","-2","0",..: 12 1 3 3 3 1 3 3 1 5 ...
# $ X9 : Factor w/ 12 levels "-1","-2","0",..: 12 1 3 3 3 3 3 3 3 3 ...
# $ X10: Factor w/ 11 levels "-1","-2","0",..: 11 2 3 3 3 3 3 3 3 3 ...
# $ X11: Factor w/ 11 levels "-1","-2","0",..: 11 2 4 3 3 3 3 3 1 3 ...
# $ X12: Factor w/ 22724 levels "-1","-10","-100",..: 22724 13345 10030 10924 15026 21268 18423 12835 1993 1518 ...
# $ X13: Factor w/ 22347 levels "-1","-10","-100",..: 22347 11404 5552 3482 15171 16961 17010 13627 12949 3530 ...
# $ X14: Factor w/ 22027 levels "-1","-10","-100",..: 22027 18440 9759 3105 15397 12421 16866 14184 17258 2072 ...
# $ X15: Factor w/ 21549 levels "-1","-10","-100",..: 21549 378 11833 3620 10318 7717 6809 16081 8147 2129 ...
# $ X16: Factor w/ 21011 levels "-1","-10","-100",..: 21011 385 11971 3950 10407 6477 6841 14580 76 1796 ...
# $ X17: Factor w/ 20605 levels "-1","-10","-100",..: 20605 415 11339 4234 10458 6345 7002 14057 15748 12215 ...
# $ X18: Factor w/ 7944 levels "0","1","10","100",..: 7944 1 1 1495 2416 2416 3160 5871 4578 4128 ...
# $ X19: Factor w/ 7900 levels "0","1","10","100",..: 7900 6671 5 1477 2536 4508 2142 4778 6189 1 ...
# $ X20: Factor w/ 7519 levels "0","1","10","100",..: 7519 1 5 5 646 6 6163 4292 1 4731 ...
# $ X21: Factor w/ 6938 levels "0","1","10","100",..: 6938 1 5 5 337 6620 5 2077 5286 5 ...
# $ X22: Factor w/ 6898 levels "0","1","10","100",..: 6898 1 1 5 263 5777 5 950 1502 5 ...
# $ X23: Factor w/ 6940 levels "0","1","10","100",..: 6940 1 2003 4751 5 5796 6293 963 1267 5 ...
# $ Y  : Factor w/ 3 levels "0","1","default payment next month": 3 2 2 1 1 1 1 1 1 1 ...
#==============================================================================================================
#==============================================================================================================

              #Pre Processing the Dataset and converting the dataset in numeric data type so than
              #we can atleast run & get results with data type as factor 
              #increases complexity and requires much more memory and computing power   

sapply(DefaultCredit,class) # all columns are factors
# X       X1       X2       X3       X4       X5       X6       X7       X8       X9      X10      X11      X12 
# "factor" "factor" "factor" "factor" "factor" "factor" "factor" "factor" "factor" "factor" "factor" "factor" "factor" 
# X13      X14      X15      X16      X17      X18      X19      X20      X21      X22      X23        Y 
# "factor" "factor" "factor" "factor" "factor" "factor" "factor" "factor" "factor" "factor" "factor" "factor" 

# Converting into Numeric
DefaultCredit[,c("X"  , "X1"  ,"X2" , "X3",  "X4",  "X5",  "X6",  "X7",  "X8", "X9" , "X10" ,"X11" ,"X12", "X13", "X14" ,"X15", "X16", "X17","X18" ,"X19" ,"X20" ,"X21" ,"X22" ,"X23","Y"  ) ] = 
  sapply(DefaultCredit[,c("X"  , "X1"  ,"X2" , "X3",  "X4",  "X5",  "X6",  "X7",  "X8", "X9" , "X10" ,"X11" ,"X12", "X13", "X14" ,"X15", "X16", "X17","X18" ,"X19" ,"X20" ,"X21" ,"X22" ,"X23","Y" )] , as.numeric)

sapply(DefaultCredit,class) # all columns are numeric other than 
# X        X1        X2        X3        X4        X5        X6        X7        X8        X9       X10       X11 
# "numeric" "numeric" "numeric" "numeric" "numeric" "numeric" "numeric" "numeric" "numeric" "numeric" "numeric" "numeric" 
# X12       X13       X14       X15       X16       X17       X18       X19       X20       X21       X22       X23 
# "numeric" "numeric" "numeric" "numeric" "numeric" "numeric" "numeric" "numeric" "numeric" "numeric" "numeric" "numeric" 
# Y 
# "numeric" 


#==============================================================================================================
#==============================================================================================================

# Spliting Dataset in Train and Test Data
set.seed(123)

trainidx = sample(nrow(DefaultCredit),nrow(DefaultCredit)*0.75)
train <- DefaultCredit[trainidx, ]
dim(train)
#[1] 22500    25

colnames(train)

test <- DefaultCredit[-trainidx, ]
dim(test)
#[1] 7501   25


colnames(test)

#==============================================================================================================

# Building Linear Model

lm.fit = lm(Y ~ ., data=train)
summary(lm.fit)


# Call:
#   lm(formula = Y ~ ., data = train)
# 
# Residuals:
#   Min       1Q   Median       3Q      Max 
# -1.17051 -0.24496 -0.17638  0.01957  1.10363 
# 
# Coefficients:
#   Estimate Std. Error t value Pr(>|t|)    
# (Intercept)  1.083e+00  2.455e-02  44.102  < 2e-16 ***
#   X            3.104e-07  3.037e-07   1.022  0.30680    
#   X1          -3.378e-04  1.220e-04  -2.769  0.00562 ** 
#   X2          -1.644e-02  5.424e-03  -3.031  0.00244 ** 
#   X3          -9.055e-03  3.435e-03  -2.636  0.00840 ** 
#   X4          -2.201e-02  5.540e-03  -3.972 7.15e-05 ***
#   X5           7.331e-04  3.185e-04   2.302  0.02137 *  
#   X6           6.751e-02  3.004e-03  22.474  < 2e-16 ***
#   X7           2.167e-02  3.575e-03   6.062 1.36e-09 ***
#   X8           1.610e-02  3.724e-03   4.322 1.55e-05 ***
#   X9           2.461e-02  3.923e-03   6.274 3.58e-10 ***
#   X10         -1.343e-02  4.988e-03  -2.692  0.00711 ** 
#   X11         -8.674e-03  4.402e-03  -1.970  0.04882 *  
#   X12          5.889e-07  4.902e-07   1.201  0.22959    
#   X13         -6.439e-07  5.769e-07  -1.116  0.26438    
# X14          3.151e-07  5.867e-07   0.537  0.59126    
# X15          6.400e-08  5.901e-07   0.108  0.91364    
# X16         -8.873e-08  5.973e-07  -0.149  0.88191    
# X17         -2.420e-08  5.679e-07  -0.043  0.96601    
# X18         -8.173e-06  1.400e-06  -5.839 5.33e-09 ***
#   X19         -4.426e-06  1.441e-06  -3.072  0.00213 ** 
#   X20         -1.381e-06  1.431e-06  -0.965  0.33440    
# X21         -7.733e-06  1.484e-06  -5.212 1.89e-07 ***
#   X22         -3.491e-06  1.514e-06  -2.306  0.02113 *  
#   X23         -1.180e-06  1.331e-06  -0.886  0.37547    
# ---
#   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# 
# Residual standard error: 0.3931 on 22475 degrees of freedom
# Multiple R-squared:  0.1092,	Adjusted R-squared:  0.1083 
# F-statistic: 114.8 on 24 and 22475 DF,  p-value: < 2.2e-16

#==============================================================================================================

#Best Subset Selection
library(leaps)
reg.fit = regsubsets(Y ~., data = train,nbest=10,nvmax=5)
summary(reg.fit)

#============================= Best Subset selection Algorithm is selected as Exaustive=============================

# 
# Subset selection object
# Call: regsubsets.formula(Y ~ ., data = train, nbest = 10, nvmax = 5)
# 24 Variables  (and intercept)
# Forced in Forced out
# X       FALSE      FALSE
# X1      FALSE      FALSE
# X2      FALSE      FALSE
# X3      FALSE      FALSE
# X4      FALSE      FALSE
# X5      FALSE      FALSE
# X6      FALSE      FALSE
# X7      FALSE      FALSE
# X8      FALSE      FALSE
# X9      FALSE      FALSE
# X10     FALSE      FALSE
# X11     FALSE      FALSE
# X12     FALSE      FALSE
# X13     FALSE      FALSE
# X14     FALSE      FALSE
# X15     FALSE      FALSE
# X16     FALSE      FALSE
# X17     FALSE      FALSE
# X18     FALSE      FALSE
# X19     FALSE      FALSE
# X20     FALSE      FALSE
# X21     FALSE      FALSE
# X22     FALSE      FALSE
# X23     FALSE      FALSE
# 10 subsets of each size up to 5
# Selection Algorithm: exhaustive
# X   X1  X2  X3  X4  X5  X6  X7  X8  X9  X10 X11 X12 X13 X14 X15 X16 X17 X18 X19 X20 X21 X22 X23
# 1  ( 1 )  " " " " " " " " " " " " "*" " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " "
# 1  ( 2 )  " " " " " " " " " " " " " " "*" " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " "
# 1  ( 3 )  " " " " " " " " " " " " " " " " "*" " " " " " " " " " " " " " " " " " " " " " " " " " " " " " "
# 1  ( 4 )  " " " " " " " " " " " " " " " " " " "*" " " " " " " " " " " " " " " " " " " " " " " " " " " " "
# 1  ( 5 )  " " " " " " " " " " " " " " " " " " " " "*" " " " " " " " " " " " " " " " " " " " " " " " " " "
# 1  ( 6 )  " " " " " " " " " " " " " " " " " " " " " " "*" " " " " " " " " " " " " " " " " " " " " " " " "
# 1  ( 7 )  " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " "*" " " " " " " " " " "
# 1  ( 8 )  " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " "*" " " " " " " " "
# 1  ( 9 )  " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " "*" " " " "
# 1  ( 10 ) " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " "*" " " " " " "
# 2  ( 1 )  " " " " " " " " " " " " "*" "*" " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " "
# 2  ( 2 )  " " " " " " " " " " " " "*" " " "*" " " " " " " " " " " " " " " " " " " " " " " " " " " " " " "
# 2  ( 3 )  " " " " " " " " " " " " "*" " " " " " " " " " " " " " " " " " " " " " " "*" " " " " " " " " " "
# 2  ( 4 )  " " " " " " " " " " " " "*" " " " " "*" " " " " " " " " " " " " " " " " " " " " " " " " " " " "
# 2  ( 5 )  " " " " " " " " " " " " "*" " " " " " " " " " " " " " " " " " " " " " " " " " " " " "*" " " " "
# 2  ( 6 )  " " " " " " " " " " " " "*" " " " " " " " " " " " " " " " " " " " " " " " " "*" " " " " " " " "
# 2  ( 7 )  " " " " " " " " " " " " "*" " " " " " " " " " " " " " " " " " " " " " " " " " " "*" " " " " " "
# 2  ( 8 )  " " " " " " " " " " " " "*" " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " "*" " "
# 2  ( 9 )  " " " " " " " " " " " " "*" " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " " "*"
# 2  ( 10 ) " " " " " " " " " " " " "*" " " " " " " "*" " " " " " " " " " " " " " " " " " " " " " " " " " "
# 3  ( 1 )  " " " " " " " " " " " " "*" " " "*" " " " " " " " " " " " " " " " " " " "*" " " " " " " " " " "
# 3  ( 2 )  " " " " " " " " " " " " "*" "*" " " " " " " " " " " " " " " " " " " " " " " " " " " "*" " " " "
# 3  ( 3 )  " " " " " " " " " " " " "*" " " " " "*" " " " " " " " " " " " " " " " " "*" " " " " " " " " " "
# 3  ( 4 )  " " " " " " " " " " " " "*" "*" " " " " " " " " " " " " " " " " " " " " "*" " " " " " " " " " "
# 3  ( 5 )  " " " " " " " " " " " " "*" " " "*" " " " " " " " " " " " " " " " " " " " " " " " " "*" " " " "
# 3  ( 6 )  " " " " " " " " " " " " "*" "*" " " " " " " " " " " " " " " " " " " " " " " "*" " " " " " " " "
# 3  ( 7 )  " " " " " " " " " " " " "*" "*" " " " " " " " " " " " " " " " " " " " " " " " " "*" " " " " " "
# 3  ( 8 )  " " " " " " " " " " " " "*" " " "*" " " " " " " " " " " " " " " " " " " " " " " "*" " " " " " "
# 3  ( 9 )  " " " " " " " " " " " " "*" " " " " "*" " " " " " " " " " " " " " " " " " " "*" " " " " " " " "
# 3  ( 10 ) " " " " " " " " " " " " "*" " " " " "*" " " " " " " " " " " " " " " " " " " " " " " "*" " " " "
# 4  ( 1 )  " " " " " " " " " " " " "*" " " "*" " " " " " " " " " " " " " " " " " " "*" " " " " "*" " " " "
# 4  ( 2 )  " " " " " " " " " " " " "*" " " "*" " " " " " " " " " " " " " " " " " " "*" " " "*" " " " " " "
# 4  ( 3 )  " " " " " " " " " " " " "*" " " "*" " " " " " " " " " " " " " " " " " " "*" " " " " " " "*" " "
# 4  ( 4 )  " " " " " " " " " " " " "*" "*" " " " " " " " " " " " " " " " " " " " " "*" " " " " "*" " " " "
# 4  ( 5 )  " " " " " " " " " " " " "*" " " "*" "*" " " " " " " " " " " " " " " " " "*" " " " " " " " " " "
# 4  ( 6 )  " " " " " " " " "*" " " "*" " " "*" " " " " " " " " " " " " " " " " " " "*" " " " " " " " " " "
# 4  ( 7 )  " " " " " " " " " " " " "*" "*" "*" " " " " " " " " " " " " " " " " " " "*" " " " " " " " " " "
# 4  ( 8 )  " " " " " " " " " " " " "*" " " " " "*" " " " " " " " " " " " " " " " " "*" " " " " "*" " " " "
# 4  ( 9 )  " " " " " " " " " " " " "*" " " "*" " " " " " " " " " " " " " " " " " " "*" " " " " " " " " "*"
# 4  ( 10 ) " " " " " " " " " " "*" "*" " " "*" " " " " " " " " " " " " " " " " " " "*" " " " " " " " " " "
# 5  ( 1 )  " " " " " " " " " " " " "*" "*" "*" " " " " " " " " " " " " " " " " " " "*" " " " " "*" " " " "
# [ reached getOption("max.print") -- omitted 9 rows ]


gc()

plot(reg.fit, scale="adjr2")
plot(reg.fit, scale="bic")

#==============================================================================================================

# Forward Selection -- to perform forward selection we need to begin by specifying
# a starting model and the range of models which we want to examine in the search

#Null model
null=lm(Y~1, data=train)
null
# 
# Call:
#   lm(formula = Y ~ 1, data = train)
# 
# Coefficients:
#   (Intercept)  
# 1.223  

#Full model
full=lm(Y~., data=train)
full
# Call:
#   lm(formula = Y ~ ., data = train)
# 
# Coefficients:
#   (Intercept)            X           X1           X2           X3           X4           X5           X6           X7  
# 1.083e+00    3.104e-07   -3.378e-04   -1.644e-02   -9.055e-03   -2.201e-02    7.331e-04    6.751e-02    2.167e-02  
# X8           X9          X10          X11          X12          X13          X14          X15          X16  
# 1.610e-02    2.461e-02   -1.343e-02   -8.674e-03    5.889e-07   -6.439e-07    3.150e-07    6.400e-08   -8.873e-08  
# X17          X18          X19          X20          X21          X22          X23  
# -2.420e-08   -8.173e-06   -4.426e-06   -1.381e-06   -7.733e-06   -3.491e-06   -1.180e-06  



#Forward Selection

step(null, scope=list(lower=null, upper=full), direction="forward")

# 
# Start:  AIC=-39437.87
# Y ~ 1
# 
# Df Sum of Sq    RSS    AIC
# + X6    1    341.31 3557.4 -41497
# + X7    1    265.18 3633.5 -41021
# + X8    1    212.54 3686.1 -40697
# + X9    1    186.96 3711.7 -40542
# + X10   1    117.97 3780.7 -40127
# + X11   1     95.84 3802.8 -39996
# + X18   1     48.01 3850.6 -39715
# + X19   1     33.91 3864.8 -39632
# + X21   1     26.34 3872.3 -39588
# + X20   1     24.33 3874.3 -39577
# + X22   1     14.81 3883.9 -39521
# + X23   1     12.93 3885.7 -39511
# + X2    1      5.23 3893.4 -39466
# + X3    1      3.86 3894.8 -39458
# + X4    1      1.46 3897.2 -39444
# + X16   1      0.89 3897.8 -39441
# + X17   1      0.50 3898.2 -39439
# + X5    1      0.46 3898.2 -39439
# <none>              3898.7 -39438
# + X13   1      0.25 3898.4 -39437
# + X1    1      0.23 3898.4 -39437
# + X12   1      0.09 3898.6 -39436
# + X14   1      0.06 3898.6 -39436
# + X15   1      0.03 3898.6 -39436
# + X     1      0.01 3898.6 -39436
# 
# Step:  AIC=-41497.22
# Y ~ X6
# 
# Df Sum of Sq    RSS    AIC
# + X7    1   26.8936 3530.5 -41666
# + X8    1   25.3905 3532.0 -41656
# + X18   1   20.9250 3536.4 -41628
# + X9    1   20.4270 3536.9 -41625
# + X21   1   16.2473 3541.1 -41598
# + X19   1   14.0966 3543.3 -41585
# + X20   1   12.0290 3545.3 -41571
# + X22   1    8.6260 3548.7 -41550
# + X23   1    6.3148 3551.0 -41535
# + X10   1    4.1282 3553.2 -41521
# + X4    1    3.0544 3554.3 -41515
# + X2    1    2.4994 3554.9 -41511
# + X5    1    1.8126 3555.5 -41507
# + X16   1    1.7719 3555.6 -41506
# + X11   1    1.6849 3555.7 -41506
# + X17   1    1.3849 3556.0 -41504
# + X13   1    1.0189 3556.3 -41502
# + X12   1    0.5236 3556.8 -41499
# + X15   1    0.5147 3556.8 -41498
# + X1    1    0.3937 3557.0 -41498
# + X14   1    0.3886 3557.0 -41498
# <none>              3557.4 -41497
# + X     1    0.0970 3557.3 -41496
# + X3    1    0.0464 3557.3 -41496
# 
# Step:  AIC=-41665.97
# Y ~ X6 + X7
# 
# Df Sum of Sq    RSS    AIC
# + X21   1   17.1717 3513.3 -41774
# + X18   1   16.0043 3514.5 -41766
# + X19   1   14.4485 3516.0 -41756
# + X20   1   12.7726 3517.7 -41746
# + X22   1    9.4954 3521.0 -41725
# + X23   1    7.1968 3523.3 -41710
# + X9    1    6.8191 3523.6 -41707
# + X8    1    6.6842 3523.8 -41707
# + X4    1    3.3112 3527.1 -41685
# + X16   1    3.2624 3527.2 -41685
# + X13   1    2.7366 3527.7 -41681
# + X17   1    2.6044 3527.9 -41681
# + X5    1    2.2756 3528.2 -41678
# + X2    1    1.8120 3528.6 -41676
# + X15   1    1.6491 3528.8 -41674
# + X14   1    1.4153 3529.0 -41673
# + X1    1    0.6219 3529.8 -41668
# + X3    1    0.3198 3530.1 -41666
# <none>              3530.5 -41666
# + X11   1    0.2448 3530.2 -41666
# + X     1    0.1202 3530.3 -41665
# + X12   1    0.1135 3530.3 -41665
# + X10   1    0.0057 3530.5 -41664
# 
# Step:  AIC=-41773.67
# Y ~ X6 + X7 + X21
# 
# Df Sum of Sq    RSS    AIC
# + X18   1   10.1180 3503.2 -41837
# + X19   1    8.1918 3505.1 -41824
# + X9    1    6.6105 3506.7 -41814
# + X8    1    6.5705 3506.7 -41814
# + X20   1    5.9554 3507.3 -41810
# + X4    1    3.3569 3509.9 -41793
# + X22   1    3.1035 3510.2 -41792
# + X5    1    2.3965 3510.9 -41787
# + X2    1    1.9304 3511.4 -41784
# + X13   1    1.9264 3511.4 -41784
# + X23   1    1.8886 3511.4 -41784
# + X17   1    1.0559 3512.2 -41778
# + X1    1    0.9450 3512.3 -41778
# + X15   1    0.7744 3512.5 -41777
# + X14   1    0.6509 3512.6 -41776
# + X3    1    0.3342 3513.0 -41774
# <none>              3513.3 -41774
# + X16   1    0.2363 3513.1 -41773
# + X     1    0.1418 3513.1 -41773
# + X10   1    0.0761 3513.2 -41772
# + X11   1    0.0542 3513.2 -41772
# + X12   1    0.0415 3513.2 -41772
# 
# Step:  AIC=-41836.56
# Y ~ X6 + X7 + X21 + X18
# 
# Df Sum of Sq    RSS    AIC
# + X8    1   10.1905 3493.0 -41900
# + X9    1    8.9199 3494.2 -41892
# + X19   1    4.0433 3499.1 -41861
# + X4    1    3.4852 3499.7 -41857
# + X20   1    3.0037 3500.2 -41854
# + X5    1    2.3840 3500.8 -41850
# + X2    1    1.8827 3501.3 -41847
# + X22   1    1.7724 3501.4 -41846
# + X1    1    1.0468 3502.1 -41841
# + X23   1    0.9286 3502.2 -41841
# + X17   1    0.3988 3502.8 -41837
# <none>              3503.2 -41837
# + X3    1    0.3108 3502.9 -41837
# + X15   1    0.1892 3503.0 -41836
# + X     1    0.1666 3503.0 -41836
# + X14   1    0.1412 3503.0 -41835
# + X13   1    0.0705 3503.1 -41835
# + X16   1    0.0262 3503.1 -41835
# + X10   1    0.0215 3503.1 -41835
# + X11   1    0.0108 3503.2 -41835
# + X12   1    0.0031 3503.2 -41835
# 
# Step:  AIC=-41900.11
# Y ~ X6 + X7 + X21 + X18 + X8
# 
# Df Sum of Sq    RSS    AIC
# + X4    1    3.7537 3489.2 -41922
# + X9    1    2.7784 3490.2 -41916
# + X5    1    2.5730 3490.4 -41915
# + X20   1    2.3084 3490.7 -41913
# + X2    1    1.7323 3491.2 -41909
# + X19   1    1.6435 3491.3 -41909
# + X22   1    1.5803 3491.4 -41908
# + X1    1    1.1365 3491.8 -41905
# + X10   1    0.9130 3492.1 -41904
# + X11   1    0.8266 3492.2 -41903
# + X23   1    0.7666 3492.2 -41903
# + X17   1    0.4976 3492.5 -41901
# + X3    1    0.4338 3492.5 -41901
# <none>              3493.0 -41900
# + X15   1    0.2927 3492.7 -41900
# + X14   1    0.2326 3492.7 -41900
# + X     1    0.1698 3492.8 -41899
# + X13   1    0.1010 3492.9 -41899
# + X16   1    0.0743 3492.9 -41899
# + X12   1    0.0001 3493.0 -41898
# 
# Step:  AIC=-41922.3
# Y ~ X6 + X7 + X21 + X18 + X8 + X4
# 
# Df Sum of Sq    RSS    AIC
# + X9    1   2.88493 3486.3 -41939
# + X20   1   2.29545 3486.9 -41935
# + X2    1   1.88908 3487.3 -41932
# + X22   1   1.63154 3487.6 -41931
# + X19   1   1.62876 3487.6 -41931
# + X1    1   1.14731 3488.1 -41928
# + X3    1   0.92149 3488.3 -41926
# + X10   1   0.83205 3488.4 -41926
# + X5    1   0.78824 3488.4 -41925
# + X23   1   0.75175 3488.5 -41925
# + X11   1   0.74525 3488.5 -41925
# + X17   1   0.48513 3488.7 -41923
# <none>              3489.2 -41922
# + X15   1   0.26964 3489.0 -41922
# + X14   1   0.20314 3489.0 -41922
# + X     1   0.17796 3489.0 -41921
# + X13   1   0.08837 3489.1 -41921
# + X16   1   0.06606 3489.2 -41921
# + X12   1   0.00002 3489.2 -41920
# 
# Step:  AIC=-41938.91
# Y ~ X6 + X7 + X21 + X18 + X8 + X4 + X9
# 
# Df Sum of Sq    RSS    AIC
# + X10   1    4.3185 3482.0 -41965
# + X11   1    2.6319 3483.7 -41954
# + X19   1    2.5276 3483.8 -41953
# + X2    1    1.8206 3484.5 -41949
# + X22   1    1.6547 3484.7 -41948
# + X20   1    1.5625 3484.8 -41947
# + X1    1    1.2050 3485.1 -41945
# + X3    1    1.0018 3485.3 -41943
# + X5    1    0.8119 3485.5 -41942
# + X23   1    0.7666 3485.6 -41942
# + X17   1    0.6349 3485.7 -41941
# + X14   1    0.3614 3486.0 -41939
# + X15   1    0.3552 3486.0 -41939
# <none>              3486.3 -41939
# + X     1    0.1971 3486.1 -41938
# + X16   1    0.1421 3486.2 -41938
# + X13   1    0.1056 3486.2 -41938
# + X12   1    0.0017 3486.3 -41937
# 
# Step:  AIC=-41964.8
# Y ~ X6 + X7 + X21 + X18 + X8 + X4 + X9 + X10
# 
# Df Sum of Sq    RSS    AIC
# + X19   1   2.05789 3480.0 -41976
# + X2    1   1.85916 3480.2 -41975
# + X22   1   1.34532 3480.7 -41971
# + X1    1   1.09615 3480.9 -41970
# + X3    1   0.89321 3481.1 -41969
# + X5    1   0.75562 3481.3 -41968
# + X20   1   0.75063 3481.3 -41968
# + X23   1   0.53390 3481.5 -41966
# + X17   1   0.40322 3481.6 -41965
# + X11   1   0.39340 3481.6 -41965
# <none>              3482.0 -41965
# + X14   1   0.25715 3481.8 -41964
# + X     1   0.20837 3481.8 -41964
# + X15   1   0.14553 3481.9 -41964
# + X13   1   0.08720 3481.9 -41963
# + X16   1   0.03997 3482.0 -41963
# + X12   1   0.00060 3482.0 -41963
# 
# Step:  AIC=-41976.1
# Y ~ X6 + X7 + X21 + X18 + X8 + X4 + X9 + X10 + X19
# 
# Df Sum of Sq    RSS    AIC
# + X2    1   1.81985 3478.1 -41986
# + X1    1   1.18428 3478.8 -41982
# + X22   1   0.98937 3479.0 -41980
# + X3    1   0.94666 3479.0 -41980
# + X5    1   0.77975 3479.2 -41979
# + X11   1   0.39555 3479.6 -41977
# + X20   1   0.35553 3479.6 -41976
# + X23   1   0.33917 3479.6 -41976
# <none>              3480.0 -41976
# + X17   1   0.25610 3479.7 -41976
# + X     1   0.19892 3479.8 -41975
# + X13   1   0.11086 3479.9 -41975
# + X15   1   0.04805 3479.9 -41974
# + X16   1   0.01596 3479.9 -41974
# + X12   1   0.00606 3480.0 -41974
# + X14   1   0.00032 3480.0 -41974
# 
# Step:  AIC=-41985.87
# Y ~ X6 + X7 + X21 + X18 + X8 + X4 + X9 + X10 + X19 + X2
# 
# Df Sum of Sq    RSS    AIC
# + X1    1   1.14765 3477.0 -41991
# + X22   1   1.01077 3477.1 -41990
# + X3    1   0.89357 3477.3 -41990
# + X5    1   0.53159 3477.6 -41987
# + X11   1   0.39249 3477.8 -41986
# + X20   1   0.35152 3477.8 -41986
# + X23   1   0.32519 3477.8 -41986
# <none>              3478.1 -41986
# + X17   1   0.23219 3477.9 -41985
# + X     1   0.16614 3478.0 -41985
# + X13   1   0.12316 3478.0 -41985
# + X15   1   0.04578 3478.1 -41984
# + X16   1   0.01237 3478.1 -41984
# + X12   1   0.00623 3478.1 -41984
# + X14   1   0.00055 3478.1 -41984
# 
# Step:  AIC=-41991.29
# Y ~ X6 + X7 + X21 + X18 + X8 + X4 + X9 + X10 + X19 + X2 + X1
# 
# Df Sum of Sq    RSS    AIC
# + X22   1   1.05692 3475.9 -41996
# + X3    1   0.83448 3476.2 -41995
# + X5    1   0.53889 3476.5 -41993
# + X20   1   0.39563 3476.6 -41992
# + X11   1   0.37130 3476.6 -41992
# + X23   1   0.35018 3476.6 -41992
# <none>              3477.0 -41991
# + X     1   0.16387 3476.8 -41990
# + X17   1   0.15321 3476.8 -41990
# + X12   1   0.09268 3476.9 -41990
# + X14   1   0.02662 3477.0 -41989
# + X13   1   0.01933 3477.0 -41989
# + X15   1   0.01144 3477.0 -41989
# + X16   1   0.00068 3477.0 -41989
# 
# Step:  AIC=-41996.14
# Y ~ X6 + X7 + X21 + X18 + X8 + X4 + X9 + X10 + X19 + X2 + X1 + 
#   X22
# 
# Df Sum of Sq    RSS    AIC
# + X3    1   0.84472 3475.1 -42000
# + X11   1   0.68041 3475.3 -41999
# + X5    1   0.56951 3475.4 -41998
# <none>              3475.9 -41996
# + X20   1   0.21617 3475.7 -41996
# + X     1   0.17041 3475.8 -41995
# + X23   1   0.12320 3475.8 -41995
# + X12   1   0.09230 3475.8 -41995
# + X13   1   0.02546 3475.9 -41994
# + X14   1   0.02104 3475.9 -41994
# + X15   1   0.00619 3475.9 -41994
# + X17   1   0.00384 3475.9 -41994
# + X16   1   0.00181 3475.9 -41994
# 
# Step:  AIC=-41999.6
# Y ~ X6 + X7 + X21 + X18 + X8 + X4 + X9 + X10 + X19 + X2 + X1 + 
#   X22 + X3
# 
# Df Sum of Sq    RSS    AIC
# + X5    1   0.80382 3474.3 -42003
# + X11   1   0.65529 3474.4 -42002
# <none>              3475.1 -42000
# + X20   1   0.21397 3474.9 -41999
# + X     1   0.16768 3474.9 -41999
# + X23   1   0.13509 3475.0 -41998
# + X12   1   0.10538 3475.0 -41998
# + X14   1   0.02769 3475.1 -41998
# + X13   1   0.01922 3475.1 -41998
# + X15   1   0.00510 3475.1 -41998
# + X17   1   0.00400 3475.1 -41998
# + X16   1   0.00151 3475.1 -41998
# 
# Step:  AIC=-42002.81
# Y ~ X6 + X7 + X21 + X18 + X8 + X4 + X9 + X10 + X19 + X2 + X1 + 
#   X22 + X3 + X5
# 
# Df Sum of Sq    RSS    AIC
# + X11   1   0.64623 3473.6 -42005
# <none>              3474.3 -42003
# + X20   1   0.21988 3474.1 -42002
# + X     1   0.16256 3474.1 -42002
# + X23   1   0.15224 3474.1 -42002
# + X12   1   0.11678 3474.2 -42002
# + X14   1   0.03428 3474.3 -42001
# + X13   1   0.01462 3474.3 -42001
# + X15   1   0.00254 3474.3 -42001
# + X17   1   0.00198 3474.3 -42001
# + X16   1   0.00056 3474.3 -42001
# 
# Step:  AIC=-42004.99
# Y ~ X6 + X7 + X21 + X18 + X8 + X4 + X9 + X10 + X19 + X2 + X1 + 
#   X22 + X3 + X5 + X11
# 
# Df Sum of Sq    RSS    AIC
# <none>              3473.6 -42005
# + X20   1  0.180451 3473.5 -42004
# + X     1  0.155354 3473.5 -42004
# + X23   1  0.144596 3473.5 -42004
# + X12   1  0.129681 3473.5 -42004
# + X14   1  0.037596 3473.6 -42003
# + X13   1  0.012856 3473.6 -42003
# + X15   1  0.001108 3473.6 -42003
# + X17   1  0.000510 3473.6 -42003
# + X16   1  0.000046 3473.6 -42003
# 
# Call:
#   lm(formula = Y ~ X6 + X7 + X21 + X18 + X8 + X4 + X9 + X10 + X19 + 
#        X2 + X1 + X22 + X3 + X5 + X11, data = train)
# 
# Coefficients:
#   (Intercept)           X6           X7          X21          X18           X8           X4           X9          X10  
# 1.088e+00    6.704e-02    2.153e-02   -8.273e-06   -9.041e-06    1.624e-02   -2.205e-02    2.575e-02   -1.412e-02  
# X19           X2           X1          X22           X3           X5          X11  
# -4.292e-06   -1.662e-02   -3.183e-04   -4.013e-06   -8.946e-03    7.218e-04   -8.950e-03 




# Backward Selection
step(full, data=train, direction="backward")
# 
# Start:  AIC=-41992.16
# Y ~ X + X1 + X2 + X3 + X4 + X5 + X6 + X7 + X8 + X9 + X10 + X11 + 
#   X12 + X13 + X14 + X15 + X16 + X17 + X18 + X19 + X20 + X21 + 
#   X22 + X23
# 
# Df Sum of Sq    RSS    AIC
# - X17   1     0.000 3472.8 -41994
# - X15   1     0.002 3472.8 -41994
# - X16   1     0.003 3472.9 -41994
# - X14   1     0.045 3472.9 -41994
# - X23   1     0.121 3473.0 -41993
# - X20   1     0.144 3473.0 -41993
# - X     1     0.161 3473.0 -41993
# - X13   1     0.192 3473.0 -41993
# - X12   1     0.223 3473.1 -41993
# <none>              3472.8 -41992
# - X11   1     0.600 3473.4 -41990
# - X5    1     0.819 3473.7 -41989
# - X22   1     0.822 3473.7 -41989
# - X3    1     1.074 3473.9 -41987
# - X10   1     1.120 3474.0 -41987
# - X1    1     1.185 3474.0 -41986
# - X2    1     1.419 3474.3 -41985
# - X19   1     1.459 3474.3 -41985
# - X4    1     2.438 3475.3 -41978
# - X8    1     2.887 3475.7 -41975
# - X21   1     4.197 3477.0 -41967
# - X18   1     5.268 3478.1 -41960
# - X7    1     5.679 3478.5 -41957
# - X9    1     6.083 3478.9 -41955
# - X6    1    78.044 3550.9 -41494
# 
# Step:  AIC=-41994.15
# Y ~ X + X1 + X2 + X3 + X4 + X5 + X6 + X7 + X8 + X9 + X10 + X11 + 
#   X12 + X13 + X14 + X15 + X16 + X18 + X19 + X20 + X21 + X22 + 
#   X23
# 
# Df Sum of Sq    RSS    AIC
# - X15   1     0.002 3472.9 -41996
# - X16   1     0.005 3472.9 -41996
# - X14   1     0.044 3472.9 -41996
# - X23   1     0.121 3473.0 -41995
# - X20   1     0.144 3473.0 -41995
# - X     1     0.161 3473.0 -41995
# - X13   1     0.193 3473.0 -41995
# - X12   1     0.223 3473.1 -41995
# <none>              3472.8 -41994
# - X11   1     0.606 3473.5 -41992
# - X5    1     0.819 3473.7 -41991
# - X22   1     0.997 3473.8 -41990
# - X3    1     1.073 3473.9 -41989
# - X10   1     1.120 3474.0 -41989
# - X1    1     1.187 3474.0 -41988
# - X2    1     1.421 3474.3 -41987
# - X19   1     1.459 3474.3 -41987
# - X4    1     2.438 3475.3 -41980
# - X8    1     2.887 3475.7 -41977
# - X21   1     4.301 3477.1 -41968
# - X18   1     5.268 3478.1 -41962
# - X7    1     5.679 3478.5 -41959
# - X9    1     6.084 3478.9 -41957
# - X6    1    78.044 3550.9 -41496
# 
# Step:  AIC=-41996.14
# Y ~ X + X1 + X2 + X3 + X4 + X5 + X6 + X7 + X8 + X9 + X10 + X11 + 
#   X12 + X13 + X14 + X16 + X18 + X19 + X20 + X21 + X22 + X23
# 
# Df Sum of Sq    RSS    AIC
# - X16   1     0.004 3472.9 -41998
# - X14   1     0.055 3472.9 -41998
# - X23   1     0.121 3473.0 -41997
# - X20   1     0.155 3473.0 -41997
# - X     1     0.162 3473.0 -41997
# - X13   1     0.191 3473.0 -41997
# - X12   1     0.225 3473.1 -41997
# <none>              3472.9 -41996
# - X11   1     0.608 3473.5 -41994
# - X5    1     0.818 3473.7 -41993
# - X22   1     0.999 3473.8 -41992
# - X3    1     1.074 3473.9 -41991
# - X10   1     1.119 3474.0 -41991
# - X1    1     1.187 3474.0 -41990
# - X2    1     1.421 3474.3 -41989
# - X19   1     1.479 3474.3 -41989
# - X4    1     2.438 3475.3 -41982
# - X8    1     2.885 3475.7 -41979
# - X21   1     4.440 3477.3 -41969
# - X18   1     5.288 3478.1 -41964
# - X7    1     5.678 3478.5 -41961
# - X9    1     6.120 3479.0 -41959
# - X6    1    78.044 3550.9 -41498
# 
# Step:  AIC=-41998.12
# Y ~ X + X1 + X2 + X3 + X4 + X5 + X6 + X7 + X8 + X9 + X10 + X11 + 
#   X12 + X13 + X14 + X18 + X19 + X20 + X21 + X22 + X23
# 
# Df Sum of Sq    RSS    AIC
# - X14   1     0.051 3472.9 -42000
# - X23   1     0.121 3473.0 -41999
# - X20   1     0.157 3473.0 -41999
# - X     1     0.162 3473.0 -41999
# - X13   1     0.198 3473.1 -41999
# - X12   1     0.223 3473.1 -41999
# <none>              3472.9 -41998
# - X11   1     0.611 3473.5 -41996
# - X5    1     0.819 3473.7 -41995
# - X22   1     0.999 3473.9 -41994
# - X3    1     1.073 3473.9 -41993
# - X10   1     1.126 3474.0 -41993
# - X1    1     1.185 3474.0 -41992
# - X2    1     1.423 3474.3 -41991
# - X19   1     1.476 3474.3 -41991
# - X4    1     2.437 3475.3 -41984
# - X8    1     2.895 3475.7 -41981
# - X21   1     4.940 3477.8 -41968
# - X18   1     5.292 3478.1 -41966
# - X7    1     5.677 3478.5 -41963
# - X9    1     6.117 3479.0 -41961
# - X6    1    78.059 3550.9 -41500
# 
# Step:  AIC=-41999.79
# Y ~ X + X1 + X2 + X3 + X4 + X5 + X6 + X7 + X8 + X9 + X10 + X11 + 
#   X12 + X13 + X18 + X19 + X20 + X21 + X22 + X23
# 
# Df Sum of Sq    RSS    AIC
# - X23   1     0.121 3473.0 -42001
# - X13   1     0.148 3473.1 -42001
# - X20   1     0.160 3473.1 -42001
# - X     1     0.162 3473.1 -42001
# - X12   1     0.272 3473.2 -42000
# <none>              3472.9 -42000
# - X11   1     0.610 3473.5 -41998
# - X5    1     0.815 3473.7 -41997
# - X22   1     1.002 3473.9 -41995
# - X3    1     1.067 3474.0 -41995
# - X10   1     1.123 3474.0 -41995
# - X1    1     1.165 3474.1 -41994
# - X2    1     1.423 3474.3 -41993
# - X19   1     1.522 3474.4 -41992
# - X4    1     2.432 3475.3 -41986
# - X8    1     3.023 3475.9 -41982
# - X21   1     4.932 3477.8 -41970
# - X7    1     5.626 3478.5 -41965
# - X18   1     5.740 3478.6 -41965
# - X9    1     6.126 3479.0 -41962
# - X6    1    78.148 3551.1 -41501
# 
# Step:  AIC=-42001.01
# Y ~ X + X1 + X2 + X3 + X4 + X5 + X6 + X7 + X8 + X9 + X10 + X11 + 
#   X12 + X13 + X18 + X19 + X20 + X21 + X22
# 
# Df Sum of Sq    RSS    AIC
# - X13   1     0.147 3473.2 -42002
# - X     1     0.160 3473.2 -42002
# - X20   1     0.189 3473.2 -42002
# - X12   1     0.270 3473.3 -42001
# <none>              3473.0 -42001
# - X11   1     0.614 3473.6 -41999
# - X5    1     0.800 3473.8 -41998
# - X3    1     1.052 3474.1 -41996
# - X10   1     1.143 3474.2 -41996
# - X1    1     1.156 3474.2 -41996
# - X22   1     1.224 3474.2 -41995
# - X2    1     1.435 3474.5 -41994
# - X19   1     1.578 3474.6 -41993
# - X4    1     2.446 3475.5 -41987
# - X8    1     3.033 3476.1 -41983
# - X21   1     5.437 3478.5 -41968
# - X7    1     5.598 3478.6 -41967
# - X18   1     5.837 3478.9 -41965
# - X9    1     6.141 3479.2 -41963
# - X6    1    78.413 3551.4 -41501
# 
# Step:  AIC=-42002.06
# Y ~ X + X1 + X2 + X3 + X4 + X5 + X6 + X7 + X8 + X9 + X10 + X11 + 
#   X12 + X18 + X19 + X20 + X21 + X22
# 
# Df Sum of Sq    RSS    AIC
# - X12   1     0.136 3473.3 -42003
# - X     1     0.161 3473.3 -42003
# - X20   1     0.183 3473.4 -42003
# <none>              3473.2 -42002
# - X11   1     0.612 3473.8 -42000
# - X5    1     0.808 3474.0 -41999
# - X3    1     1.063 3474.2 -41997
# - X10   1     1.146 3474.3 -41997
# - X22   1     1.208 3474.4 -41996
# - X1    1     1.255 3474.4 -41996
# - X2    1     1.418 3474.6 -41995
# - X19   1     1.537 3474.7 -41994
# - X4    1     2.450 3475.6 -41988
# - X8    1     3.047 3476.2 -41984
# - X21   1     5.435 3478.6 -41969
# - X7    1     5.511 3478.7 -41968
# - X9    1     6.135 3479.3 -41964
# - X18   1     7.601 3480.8 -41955
# - X6    1    78.268 3551.4 -41503
# 
# Step:  AIC=-42003.17
# Y ~ X + X1 + X2 + X3 + X4 + X5 + X6 + X7 + X8 + X9 + X10 + X11 + 
#   X18 + X19 + X20 + X21 + X22
# 
# Df Sum of Sq    RSS    AIC
# - X     1     0.156 3473.5 -42004
# - X20   1     0.181 3473.5 -42004
# <none>              3473.3 -42003
# - X11   1     0.600 3473.9 -42001
# - X5    1     0.795 3474.1 -42000
# - X3    1     1.045 3474.4 -41998
# - X1    1     1.140 3474.4 -41998
# - X10   1     1.141 3474.4 -41998
# - X22   1     1.205 3474.5 -41997
# - X2    1     1.422 3474.7 -41996
# - X19   1     1.502 3474.8 -41995
# - X4    1     2.447 3475.8 -41989
# - X8    1     3.064 3476.4 -41985
# - X21   1     5.417 3478.7 -41970
# - X7    1     5.886 3479.2 -41967
# - X9    1     6.138 3479.4 -41965
# - X18   1     7.510 3480.8 -41957
# - X6    1    79.828 3553.1 -41494
# 
# Step:  AIC=-42004.16
# Y ~ X1 + X2 + X3 + X4 + X5 + X6 + X7 + X8 + X9 + X10 + X11 + 
#   X18 + X19 + X20 + X21 + X22
# 
# Df Sum of Sq    RSS    AIC
# - X20   1     0.180 3473.6 -42005
# <none>              3473.5 -42004
# - X11   1     0.607 3474.1 -42002
# - X5    1     0.800 3474.3 -42001
# - X3    1     1.049 3474.5 -41999
# - X10   1     1.132 3474.6 -41999
# - X1    1     1.142 3474.6 -41999
# - X22   1     1.201 3474.7 -41998
# - X2    1     1.449 3474.9 -41997
# - X19   1     1.510 3475.0 -41996
# - X4    1     2.439 3475.9 -41990
# - X8    1     3.068 3476.5 -41986
# - X21   1     5.408 3478.9 -41971
# - X7    1     5.882 3479.3 -41968
# - X9    1     6.117 3479.6 -41967
# - X18   1     7.486 3481.0 -41958
# - X6    1    79.821 3553.3 -41495
# 
# Step:  AIC=-42004.99
# Y ~ X1 + X2 + X3 + X4 + X5 + X6 + X7 + X8 + X9 + X10 + X11 + 
#   X18 + X19 + X21 + X22
# 
# Df Sum of Sq    RSS    AIC
# <none>              3473.6 -42005
# - X11   1     0.646 3474.3 -42003
# - X5    1     0.795 3474.4 -42002
# - X3    1     1.050 3474.7 -42000
# - X1    1     1.115 3474.8 -42000
# - X10   1     1.261 3474.9 -41999
# - X22   1     1.410 3475.1 -41998
# - X2    1     1.454 3475.1 -41998
# - X19   1     1.754 3475.4 -41996
# - X4    1     2.448 3476.1 -41991
# - X8    1     2.991 3476.6 -41988
# - X7    1     5.806 3479.5 -41969
# - X21   1     5.931 3479.6 -41969
# - X9    1     7.189 3480.8 -41960
# - X18   1     8.084 3481.7 -41955
# - X6    1    79.989 3553.6 -41495
# 
# Call:
#   lm(formula = Y ~ X1 + X2 + X3 + X4 + X5 + X6 + X7 + X8 + X9 + 
#        X10 + X11 + X18 + X19 + X21 + X22, data = train)
# 
# Coefficients:
#   (Intercept)           X1           X2           X3           X4           X5           X6           X7           X8  
# 1.088e+00   -3.183e-04   -1.662e-02   -8.946e-03   -2.205e-02    7.218e-04    6.704e-02    2.153e-02    1.624e-02  
# X9          X10          X11          X18          X19          X21          X22  
# 2.575e-02   -1.412e-02   -8.950e-03   -9.041e-06   -4.292e-06   -8.273e-06   -4.013e-06  


# Stepwise Regression
step( null, scope = list(upper=full), data=train, direction="both")

# Start:  AIC=-39437.87
# Y ~ 1
# 
# Df Sum of Sq    RSS    AIC
# + X6    1    341.31 3557.4 -41497
# + X7    1    265.18 3633.5 -41021
# + X8    1    212.54 3686.1 -40697
# + X9    1    186.96 3711.7 -40542
# + X10   1    117.97 3780.7 -40127
# + X11   1     95.84 3802.8 -39996
# + X18   1     48.01 3850.6 -39715
# + X19   1     33.91 3864.8 -39632
# + X21   1     26.34 3872.3 -39588
# + X20   1     24.33 3874.3 -39577
# + X22   1     14.81 3883.9 -39521
# + X23   1     12.93 3885.7 -39511
# + X2    1      5.23 3893.4 -39466
# + X3    1      3.86 3894.8 -39458
# + X4    1      1.46 3897.2 -39444
# + X16   1      0.89 3897.8 -39441
# + X17   1      0.50 3898.2 -39439
# + X5    1      0.46 3898.2 -39439
# <none>              3898.7 -39438
# + X13   1      0.25 3898.4 -39437
# + X1    1      0.23 3898.4 -39437
# + X12   1      0.09 3898.6 -39436
# + X14   1      0.06 3898.6 -39436
# + X15   1      0.03 3898.6 -39436
# + X     1      0.01 3898.6 -39436
# 
# Step:  AIC=-41497.22
# Y ~ X6
# 
# Df Sum of Sq    RSS    AIC
# + X7    1     26.89 3530.5 -41666
# + X8    1     25.39 3532.0 -41656
# + X18   1     20.93 3536.4 -41628
# + X9    1     20.43 3536.9 -41625
# + X21   1     16.25 3541.1 -41598
# + X19   1     14.10 3543.3 -41585
# + X20   1     12.03 3545.3 -41571
# + X22   1      8.63 3548.7 -41550
# + X23   1      6.31 3551.0 -41535
# + X10   1      4.13 3553.2 -41521
# + X4    1      3.05 3554.3 -41515
# + X2    1      2.50 3554.9 -41511
# + X5    1      1.81 3555.5 -41507
# + X16   1      1.77 3555.6 -41506
# + X11   1      1.68 3555.7 -41506
# + X17   1      1.38 3556.0 -41504
# + X13   1      1.02 3556.3 -41502
# + X12   1      0.52 3556.8 -41499
# + X15   1      0.51 3556.8 -41498
# + X1    1      0.39 3557.0 -41498
# + X14   1      0.39 3557.0 -41498
# <none>              3557.4 -41497
# + X     1      0.10 3557.3 -41496
# + X3    1      0.05 3557.3 -41496
# - X6    1    341.31 3898.7 -39438
# 
# Step:  AIC=-41665.97
# Y ~ X6 + X7
# 
# Df Sum of Sq    RSS    AIC
# + X21   1    17.172 3513.3 -41774
# + X18   1    16.004 3514.5 -41766
# + X19   1    14.449 3516.0 -41756
# + X20   1    12.773 3517.7 -41746
# + X22   1     9.495 3521.0 -41725
# + X23   1     7.197 3523.3 -41710
# + X9    1     6.819 3523.6 -41707
# + X8    1     6.684 3523.8 -41707
# + X4    1     3.311 3527.1 -41685
# + X16   1     3.262 3527.2 -41685
# + X13   1     2.737 3527.7 -41681
# + X17   1     2.604 3527.9 -41681
# + X5    1     2.276 3528.2 -41678
# + X2    1     1.812 3528.6 -41676
# + X15   1     1.649 3528.8 -41674
# + X14   1     1.415 3529.0 -41673
# + X1    1     0.622 3529.8 -41668
# + X3    1     0.320 3530.1 -41666
# <none>              3530.5 -41666
# + X11   1     0.245 3530.2 -41666
# + X     1     0.120 3530.3 -41665
# + X12   1     0.113 3530.3 -41665
# + X10   1     0.006 3530.5 -41664
# - X7    1    26.894 3557.4 -41497
# - X6    1   103.022 3633.5 -41021
# 
# Step:  AIC=-41773.67
# Y ~ X6 + X7 + X21
# 
# Df Sum of Sq    RSS    AIC
# + X18   1    10.118 3503.2 -41837
# + X19   1     8.192 3505.1 -41824
# + X9    1     6.611 3506.7 -41814
# + X8    1     6.570 3506.7 -41814
# + X20   1     5.955 3507.3 -41810
# + X4    1     3.357 3509.9 -41793
# + X22   1     3.103 3510.2 -41792
# + X5    1     2.396 3510.9 -41787
# + X2    1     1.930 3511.4 -41784
# + X13   1     1.926 3511.4 -41784
# + X23   1     1.889 3511.4 -41784
# + X17   1     1.056 3512.2 -41778
# + X1    1     0.945 3512.3 -41778
# + X15   1     0.774 3512.5 -41777
# + X14   1     0.651 3512.6 -41776
# + X3    1     0.334 3513.0 -41774
# <none>              3513.3 -41774
# + X16   1     0.236 3513.1 -41773
# + X     1     0.142 3513.1 -41773
# + X10   1     0.076 3513.2 -41772
# + X11   1     0.054 3513.2 -41772
# + X12   1     0.042 3513.2 -41772
# - X21   1    17.172 3530.5 -41666
# - X7    1    27.818 3541.1 -41598
# - X6    1    97.778 3611.1 -41158
# 
# Step:  AIC=-41836.56
# Y ~ X6 + X7 + X21 + X18
# 
# Df Sum of Sq    RSS    AIC
# + X8    1    10.190 3493.0 -41900
# + X9    1     8.920 3494.2 -41892
# + X19   1     4.043 3499.1 -41861
# + X4    1     3.485 3499.7 -41857
# + X20   1     3.004 3500.2 -41854
# + X5    1     2.384 3500.8 -41850
# + X2    1     1.883 3501.3 -41847
# + X22   1     1.772 3501.4 -41846
# + X1    1     1.047 3502.1 -41841
# + X23   1     0.929 3502.2 -41841
# + X17   1     0.399 3502.8 -41837
# <none>              3503.2 -41837
# + X3    1     0.311 3502.9 -41837
# + X15   1     0.189 3503.0 -41836
# + X     1     0.167 3503.0 -41836
# + X14   1     0.141 3503.0 -41835
# + X13   1     0.071 3503.1 -41835
# + X16   1     0.026 3503.1 -41835
# + X10   1     0.021 3503.1 -41835
# + X11   1     0.011 3503.2 -41835
# + X12   1     0.003 3503.2 -41835
# - X18   1    10.118 3513.3 -41774
# - X21   1    11.285 3514.5 -41766
# - X7    1    23.445 3526.6 -41688
# - X6    1    97.404 3600.6 -41222
# 
# Step:  AIC=-41900.11
# Y ~ X6 + X7 + X21 + X18 + X8
# 
# Df Sum of Sq    RSS    AIC
# + X4    1     3.754 3489.2 -41922
# + X9    1     2.778 3490.2 -41916
# + X5    1     2.573 3490.4 -41915
# + X20   1     2.308 3490.7 -41913
# + X2    1     1.732 3491.2 -41909
# + X19   1     1.643 3491.3 -41909
# + X22   1     1.580 3491.4 -41908
# + X1    1     1.137 3491.8 -41905
# + X10   1     0.913 3492.1 -41904
# + X11   1     0.827 3492.2 -41903
# + X23   1     0.767 3492.2 -41903
# + X17   1     0.498 3492.5 -41901
# + X3    1     0.434 3492.5 -41901
# <none>              3493.0 -41900
# + X15   1     0.293 3492.7 -41900
# + X14   1     0.233 3492.7 -41900
# + X     1     0.170 3492.8 -41899
# + X13   1     0.101 3492.9 -41899
# + X16   1     0.074 3492.9 -41899
# + X12   1     0.000 3493.0 -41898
# - X7    1     4.547 3497.5 -41873
# - X8    1    10.190 3503.2 -41837
# - X21   1    10.318 3503.3 -41836
# - X18   1    13.738 3506.7 -41814
# - X6    1    85.599 3578.6 -41357
# 
# Step:  AIC=-41922.3
# Y ~ X6 + X7 + X21 + X18 + X8 + X4
# 
# Df Sum of Sq    RSS    AIC
# + X9    1     2.885 3486.3 -41939
# + X20   1     2.295 3486.9 -41935
# + X2    1     1.889 3487.3 -41932
# + X22   1     1.632 3487.6 -41931
# + X19   1     1.629 3487.6 -41931
# + X1    1     1.147 3488.1 -41928
# + X3    1     0.921 3488.3 -41926
# + X10   1     0.832 3488.4 -41926
# + X5    1     0.788 3488.4 -41925
# + X23   1     0.752 3488.5 -41925
# + X11   1     0.745 3488.5 -41925
# + X17   1     0.485 3488.7 -41923
# <none>              3489.2 -41922
# + X15   1     0.270 3489.0 -41922
# + X14   1     0.203 3489.0 -41922
# + X     1     0.178 3489.0 -41921
# + X13   1     0.088 3489.1 -41921
# + X16   1     0.066 3489.2 -41921
# + X12   1     0.000 3489.2 -41920
# - X4    1     3.754 3493.0 -41900
# - X7    1     4.527 3493.8 -41895
# - X21   1    10.314 3499.5 -41858
# - X8    1    10.459 3499.7 -41857
# - X18   1    13.947 3503.2 -41835
# - X6    1    85.893 3575.1 -41377
# 
# Step:  AIC=-41938.91
# Y ~ X6 + X7 + X21 + X18 + X8 + X4 + X9
# 
# Df Sum of Sq    RSS    AIC
# + X10   1     4.318 3482.0 -41965
# + X11   1     2.632 3483.7 -41954
# + X19   1     2.528 3483.8 -41953
# + X2    1     1.821 3484.5 -41949
# + X22   1     1.655 3484.7 -41948
# + X20   1     1.562 3484.8 -41947
# + X1    1     1.205 3485.1 -41945
# + X3    1     1.002 3485.3 -41943
# + X5    1     0.812 3485.5 -41942
# + X23   1     0.767 3485.6 -41942
# + X17   1     0.635 3485.7 -41941
# + X14   1     0.361 3486.0 -41939
# + X15   1     0.355 3486.0 -41939
# <none>              3486.3 -41939
# + X     1     0.197 3486.1 -41938
# + X16   1     0.142 3486.2 -41938
# + X13   1     0.106 3486.2 -41938
# + X12   1     0.002 3486.3 -41937
# - X9    1     2.885 3489.2 -41922
# - X7    1     3.608 3489.9 -41918
# - X4    1     3.860 3490.2 -41916
# - X8    1     4.141 3490.5 -41914
# - X21   1    10.126 3496.5 -41876
# - X18   1    14.450 3500.8 -41848
# - X6    1    79.558 3565.9 -41433
# 
# Step:  AIC=-41964.8
# Y ~ X6 + X7 + X21 + X18 + X8 + X4 + X9 + X10
# 
# Df Sum of Sq    RSS    AIC
# + X19   1     2.058 3480.0 -41976
# + X2    1     1.859 3480.2 -41975
# + X22   1     1.345 3480.7 -41971
# + X1    1     1.096 3480.9 -41970
# + X3    1     0.893 3481.1 -41969
# + X5    1     0.756 3481.3 -41968
# + X20   1     0.751 3481.3 -41968
# + X23   1     0.534 3481.5 -41966
# + X17   1     0.403 3481.6 -41965
# + X11   1     0.393 3481.6 -41965
# <none>              3482.0 -41965
# + X14   1     0.257 3481.8 -41964
# + X     1     0.208 3481.8 -41964
# + X15   1     0.146 3481.9 -41964
# + X13   1     0.087 3481.9 -41963
# + X16   1     0.040 3482.0 -41963
# + X12   1     0.001 3482.0 -41963
# - X4    1     3.726 3485.7 -41943
# - X10   1     4.318 3486.3 -41939
# - X7    1     4.588 3486.6 -41937
# - X8    1     4.741 3486.8 -41936
# - X9    1     6.371 3488.4 -41926
# - X21   1    11.495 3493.5 -41893
# - X18   1    13.396 3495.4 -41880
# - X6    1    81.469 3563.5 -41446
# 
# Step:  AIC=-41976.1
# Y ~ X6 + X7 + X21 + X18 + X8 + X4 + X9 + X10 + X19
# 
# Df Sum of Sq    RSS    AIC
# + X2    1     1.820 3478.1 -41986
# + X1    1     1.184 3478.8 -41982
# + X22   1     0.989 3479.0 -41980
# + X3    1     0.947 3479.0 -41980
# + X5    1     0.780 3479.2 -41979
# + X11   1     0.396 3479.6 -41977
# + X20   1     0.356 3479.6 -41976
# + X23   1     0.339 3479.6 -41976
# <none>              3480.0 -41976
# + X17   1     0.256 3479.7 -41976
# + X     1     0.199 3479.8 -41975
# + X13   1     0.111 3479.9 -41975
# + X15   1     0.048 3479.9 -41974
# + X16   1     0.016 3479.9 -41974
# + X12   1     0.006 3480.0 -41974
# + X14   1     0.000 3480.0 -41974
# - X19   1     2.058 3482.0 -41965
# - X8    1     2.746 3482.7 -41960
# - X4    1     3.731 3483.7 -41954
# - X10   1     3.849 3483.8 -41953
# - X7    1     5.417 3485.4 -41943
# - X9    1     7.106 3487.1 -41932
# - X18   1     8.857 3488.8 -41921
# - X21   1     9.223 3489.2 -41919
# - X6    1    79.175 3559.1 -41472
# 
# Step:  AIC=-41985.87
# Y ~ X6 + X7 + X21 + X18 + X8 + X4 + X9 + X10 + X19 + X2
# 
# Df Sum of Sq    RSS    AIC
# + X1    1     1.148 3477.0 -41991
# + X22   1     1.011 3477.1 -41990
# + X3    1     0.894 3477.3 -41990
# + X5    1     0.532 3477.6 -41987
# + X11   1     0.392 3477.8 -41986
# + X20   1     0.352 3477.8 -41986
# + X23   1     0.325 3477.8 -41986
# <none>              3478.1 -41986
# + X17   1     0.232 3477.9 -41985
# + X     1     0.166 3478.0 -41985
# + X13   1     0.123 3478.0 -41985
# + X15   1     0.046 3478.1 -41984
# + X16   1     0.012 3478.1 -41984
# + X12   1     0.006 3478.1 -41984
# + X14   1     0.001 3478.1 -41984
# - X2    1     1.820 3480.0 -41976
# - X19   1     2.019 3480.2 -41975
# - X8    1     2.728 3480.9 -41970
# - X4    1     3.883 3482.0 -41963
# - X10   1     3.889 3482.0 -41963
# - X7    1     5.262 3483.4 -41954
# - X9    1     7.031 3485.2 -41942
# - X18   1     8.815 3487.0 -41931
# - X21   1     9.343 3487.5 -41928
# - X6    1    79.362 3557.5 -41480
# 
# Step:  AIC=-41991.29
# Y ~ X6 + X7 + X21 + X18 + X8 + X4 + X9 + X10 + X19 + X2 + X1
# 
# Df Sum of Sq    RSS    AIC
# + X22   1     1.057 3475.9 -41996
# + X3    1     0.834 3476.2 -41995
# + X5    1     0.539 3476.5 -41993
# + X20   1     0.396 3476.6 -41992
# + X11   1     0.371 3476.6 -41992
# + X23   1     0.350 3476.6 -41992
# <none>              3477.0 -41991
# + X     1     0.164 3476.8 -41990
# + X17   1     0.153 3476.8 -41990
# + X12   1     0.093 3476.9 -41990
# + X14   1     0.027 3477.0 -41989
# + X13   1     0.019 3477.0 -41989
# + X15   1     0.011 3477.0 -41989
# + X16   1     0.001 3477.0 -41989
# - X1    1     1.148 3478.1 -41986
# - X2    1     1.783 3478.8 -41982
# - X19   1     2.105 3479.1 -41980
# - X8    1     2.707 3479.7 -41976
# - X10   1     3.774 3480.8 -41969
# - X4    1     3.895 3480.9 -41968
# - X7    1     5.338 3482.3 -41959
# - X9    1     7.053 3484.0 -41948
# - X18   1     8.877 3485.9 -41936
# - X21   1     9.527 3486.5 -41932
# - X6    1    79.585 3556.6 -41484
# 
# Step:  AIC=-41996.14
# Y ~ X6 + X7 + X21 + X18 + X8 + X4 + X9 + X10 + X19 + X2 + X1 + 
#   X22
# 
# Df Sum of Sq    RSS    AIC
# + X3    1     0.845 3475.1 -42000
# + X11   1     0.680 3475.3 -41999
# + X5    1     0.570 3475.4 -41998
# <none>              3475.9 -41996
# + X20   1     0.216 3475.7 -41996
# + X     1     0.170 3475.8 -41995
# + X23   1     0.123 3475.8 -41995
# + X12   1     0.092 3475.8 -41995
# + X13   1     0.025 3475.9 -41994
# + X14   1     0.021 3475.9 -41994
# + X15   1     0.006 3475.9 -41994
# + X17   1     0.004 3475.9 -41994
# + X16   1     0.002 3475.9 -41994
# - X22   1     1.057 3477.0 -41991
# - X1    1     1.194 3477.1 -41990
# - X19   1     1.735 3477.7 -41987
# - X2    1     1.804 3477.7 -41986
# - X8    1     2.739 3478.7 -41980
# - X10   1     3.553 3479.5 -41975
# - X4    1     3.943 3479.9 -41973
# - X7    1     5.426 3481.4 -41963
# - X9    1     6.823 3482.8 -41954
# - X21   1     7.022 3483.0 -41953
# - X18   1     8.260 3484.2 -41945
# - X6    1    79.018 3555.0 -41492
# 
# Step:  AIC=-41999.6
# Y ~ X6 + X7 + X21 + X18 + X8 + X4 + X9 + X10 + X19 + X2 + X1 + 
#   X22 + X3
# 
# Df Sum of Sq    RSS    AIC
# + X5    1     0.804 3474.3 -42003
# + X11   1     0.655 3474.4 -42002
# <none>              3475.1 -42000
# + X20   1     0.214 3474.9 -41999
# + X     1     0.168 3474.9 -41999
# + X23   1     0.135 3475.0 -41998
# + X12   1     0.105 3475.0 -41998
# + X14   1     0.028 3475.1 -41998
# + X13   1     0.019 3475.1 -41998
# + X15   1     0.005 3475.1 -41998
# + X17   1     0.004 3475.1 -41998
# + X16   1     0.002 3475.1 -41998
# - X3    1     0.845 3475.9 -41996
# - X22   1     1.067 3476.2 -41995
# - X1    1     1.133 3476.2 -41994
# - X2    1     1.754 3476.8 -41990
# - X19   1     1.778 3476.9 -41990
# - X8    1     2.774 3477.9 -41984
# - X10   1     3.454 3478.5 -41979
# - X4    1     4.415 3479.5 -41973
# - X7    1     5.563 3480.7 -41966
# - X9    1     6.864 3482.0 -41957
# - X21   1     6.989 3482.1 -41956
# - X18   1     8.244 3483.3 -41948
# - X6    1    79.448 3554.5 -41493
# 
# Step:  AIC=-42002.81
# Y ~ X6 + X7 + X21 + X18 + X8 + X4 + X9 + X10 + X19 + X2 + X1 + 
#   X22 + X3 + X5
# 
# Df Sum of Sq    RSS    AIC
# + X11   1     0.646 3473.6 -42005
# <none>              3474.3 -42003
# + X20   1     0.220 3474.1 -42002
# + X     1     0.163 3474.1 -42002
# + X23   1     0.152 3474.1 -42002
# + X12   1     0.117 3474.2 -42002
# + X14   1     0.034 3474.3 -42001
# + X13   1     0.015 3474.3 -42001
# + X15   1     0.003 3474.3 -42001
# + X17   1     0.002 3474.3 -42001
# + X16   1     0.001 3474.3 -42001
# - X5    1     0.804 3475.1 -42000
# - X3    1     1.079 3475.4 -41998
# - X22   1     1.106 3475.4 -41998
# - X1    1     1.135 3475.4 -41997
# - X2    1     1.452 3475.7 -41995
# - X19   1     1.805 3476.1 -41993
# - X4    1     2.471 3476.8 -41989
# - X8    1     2.785 3477.1 -41987
# - X10   1     3.377 3477.7 -41983
# - X7    1     5.661 3480.0 -41968
# - X9    1     6.871 3481.2 -41960
# - X21   1     6.975 3481.3 -41960
# - X18   1     8.204 3482.5 -41952
# - X6    1    79.431 3553.7 -41496
# 
# Step:  AIC=-42004.99
# Y ~ X6 + X7 + X21 + X18 + X8 + X4 + X9 + X10 + X19 + X2 + X1 + 
#   X22 + X3 + X5 + X11
# 
# Df Sum of Sq    RSS    AIC
# <none>              3473.6 -42005
# + X20   1     0.180 3473.5 -42004
# + X     1     0.155 3473.5 -42004
# + X23   1     0.145 3473.5 -42004
# + X12   1     0.130 3473.5 -42004
# + X14   1     0.038 3473.6 -42003
# + X13   1     0.013 3473.6 -42003
# + X15   1     0.001 3473.6 -42003
# + X17   1     0.001 3473.6 -42003
# + X16   1     0.000 3473.6 -42003
# - X11   1     0.646 3474.3 -42003
# - X5    1     0.795 3474.4 -42002
# - X3    1     1.050 3474.7 -42000
# - X1    1     1.115 3474.8 -42000
# - X10   1     1.261 3474.9 -41999
# - X22   1     1.410 3475.1 -41998
# - X2    1     1.454 3475.1 -41998
# - X19   1     1.754 3475.4 -41996
# - X4    1     2.448 3476.1 -41991
# - X8    1     2.991 3476.6 -41988
# - X7    1     5.806 3479.5 -41969
# - X21   1     5.931 3479.6 -41969
# - X9    1     7.189 3480.8 -41960
# - X18   1     8.084 3481.7 -41955
# - X6    1    79.989 3553.6 -41495
# 
# Call:
#   lm(formula = Y ~ X6 + X7 + X21 + X18 + X8 + X4 + X9 + X10 + X19 + 
#        X2 + X1 + X22 + X3 + X5 + X11, data = train)
# 
# Coefficients:
#   (Intercept)           X6           X7          X21          X18           X8           X4           X9          X10  
# 1.088e+00    6.704e-02    2.153e-02   -8.273e-06   -9.041e-06    1.624e-02   -2.205e-02    2.575e-02   -1.412e-02  
# X19           X2           X1          X22           X3           X5          X11  
# -4.292e-06   -1.662e-02   -3.183e-04   -4.013e-06   -8.946e-03    7.218e-04   -8.950e-03  

#============================= Train & Test Error=============================# 

attach(test)

#Estimating Test MSE 
mean((Y-predict(lm.fit,test))[-trainidx]^2)
#[1] 0.1576911


#K fold Cross Validation
# Observations are split into K partitions, 
# the model is trained on K - 1 partitions, and the test error is predicted on the left out partition k.

library(boot)
glm.fit=glm(Y~X, data = DefaultCredit)
cv.err = cv.glm(DefaultCredit,glm.fit,K=10)
cv.err$delta
#[1] 0.1723897 0.1723886


gc()
#==============================================================================================================

                            ########################## Q2 ##########################

#==============================================================================================================

# Loading Data 

OnlineNewsPopularity <- read.csv("D:/Downloads/OnlineNewsPopularity.csv")
colnames(OnlineNewsPopularity)
# [1] "url"                           "timedelta"                     "n_tokens_title"               
# [4] "n_tokens_content"              "n_unique_tokens"               "n_non_stop_words"             
# [7] "n_non_stop_unique_tokens"      "num_hrefs"                     "num_self_hrefs"               
# [10] "num_imgs"                      "num_videos"                    "average_token_length"         
# [13] "num_keywords"                  "data_channel_is_lifestyle"     "data_channel_is_entertainment"
# [16] "data_channel_is_bus"           "data_channel_is_socmed"        "data_channel_is_tech"         
# [19] "data_channel_is_world"         "kw_min_min"                    "kw_max_min"                   
# [22] "kw_avg_min"                    "kw_min_max"                    "kw_max_max"                   
# [25] "kw_avg_max"                    "kw_min_avg"                    "kw_max_avg"                   
# [28] "kw_avg_avg"                    "self_reference_min_shares"     "self_reference_max_shares"    
# [31] "self_reference_avg_sharess"    "weekday_is_monday"             "weekday_is_tuesday"           
# [34] "weekday_is_wednesday"          "weekday_is_thursday"           "weekday_is_friday"            
# [37] "weekday_is_saturday"           "weekday_is_sunday"             "is_weekend"                   
# [40] "LDA_00"                        "LDA_01"                        "LDA_02"                       
# [43] "LDA_03"                        "LDA_04"                        "global_subjectivity"          
# [46] "global_sentiment_polarity"     "global_rate_positive_words"    "global_rate_negative_words"   
# [49] "rate_positive_words"           "rate_negative_words"           "avg_positive_polarity"        
# [52] "min_positive_polarity"         "max_positive_polarity"         "avg_negative_polarity"        
# [55] "min_negative_polarity"         "max_negative_polarity"         "title_subjectivity"           
# [58] "title_sentiment_polarity"      "abs_title_subjectivity"        "abs_title_sentiment_polarity" 
# [61] "shares"                       

summary(OnlineNewsPopularity)

# url          timedelta     n_tokens_title n_tokens_content
# http://mashable.com/2013/01/07/amazon-instant-video-browser/  :    1   Min.   :  8.0   Min.   : 2.0   Min.   :   0.0  
# http://mashable.com/2013/01/07/ap-samsung-sponsored-tweets/   :    1   1st Qu.:164.0   1st Qu.: 9.0   1st Qu.: 246.0  
# http://mashable.com/2013/01/07/apple-40-billion-app-downloads/:    1   Median :339.0   Median :10.0   Median : 409.0  
# http://mashable.com/2013/01/07/astronaut-notre-dame-bcs/      :    1   Mean   :354.5   Mean   :10.4   Mean   : 546.5  
# http://mashable.com/2013/01/07/att-u-verse-apps/              :    1   3rd Qu.:542.0   3rd Qu.:12.0   3rd Qu.: 716.0  
# http://mashable.com/2013/01/07/beewi-smart-toys/              :    1   Max.   :731.0   Max.   :23.0   Max.   :8474.0  
# (Other)                                                       :39638                                                  
# n_unique_tokens    n_non_stop_words    n_non_stop_unique_tokens   num_hrefs      num_self_hrefs       num_imgs      
# Min.   :  0.0000   Min.   :   0.0000   Min.   :  0.0000         Min.   :  0.00   Min.   :  0.000   Min.   :  0.000  
# 1st Qu.:  0.4709   1st Qu.:   1.0000   1st Qu.:  0.6257         1st Qu.:  4.00   1st Qu.:  1.000   1st Qu.:  1.000  
# Median :  0.5392   Median :   1.0000   Median :  0.6905         Median :  8.00   Median :  3.000   Median :  1.000  
# Mean   :  0.5482   Mean   :   0.9965   Mean   :  0.6892         Mean   : 10.88   Mean   :  3.294   Mean   :  4.544  
# 3rd Qu.:  0.6087   3rd Qu.:   1.0000   3rd Qu.:  0.7546         3rd Qu.: 14.00   3rd Qu.:  4.000   3rd Qu.:  4.000  
# Max.   :701.0000   Max.   :1042.0000   Max.   :650.0000         Max.   :304.00   Max.   :116.000   Max.   :128.000  
# 
# num_videos    average_token_length  num_keywords    data_channel_is_lifestyle data_channel_is_entertainment
# Min.   : 0.00   Min.   :0.000        Min.   : 1.000   Min.   :0.00000           Min.   :0.000                
# 1st Qu.: 0.00   1st Qu.:4.478        1st Qu.: 6.000   1st Qu.:0.00000           1st Qu.:0.000                
# Median : 0.00   Median :4.664        Median : 7.000   Median :0.00000           Median :0.000                
# Mean   : 1.25   Mean   :4.548        Mean   : 7.224   Mean   :0.05295           Mean   :0.178                
# 3rd Qu.: 1.00   3rd Qu.:4.855        3rd Qu.: 9.000   3rd Qu.:0.00000           3rd Qu.:0.000                
# Max.   :91.00   Max.   :8.042        Max.   :10.000   Max.   :1.00000           Max.   :1.000                
# 
# data_channel_is_bus data_channel_is_socmed data_channel_is_tech data_channel_is_world   kw_min_min       kw_max_min    
# Min.   :0.0000      Min.   :0.0000         Min.   :0.0000       Min.   :0.0000        Min.   : -1.00   Min.   :     0  
# 1st Qu.:0.0000      1st Qu.:0.0000         1st Qu.:0.0000       1st Qu.:0.0000        1st Qu.: -1.00   1st Qu.:   445  
# Median :0.0000      Median :0.0000         Median :0.0000       Median :0.0000        Median : -1.00   Median :   660  
# Mean   :0.1579      Mean   :0.0586         Mean   :0.1853       Mean   :0.2126        Mean   : 26.11   Mean   :  1154  
# 3rd Qu.:0.0000      3rd Qu.:0.0000         3rd Qu.:0.0000       3rd Qu.:0.0000        3rd Qu.:  4.00   3rd Qu.:  1000  
# Max.   :1.0000      Max.   :1.0000         Max.   :1.0000       Max.   :1.0000        Max.   :377.00   Max.   :298400  
# 
# kw_avg_min        kw_min_max       kw_max_max       kw_avg_max       kw_min_avg     kw_max_avg       kw_avg_avg   
# Min.   :   -1.0   Min.   :     0   Min.   :     0   Min.   :     0   Min.   :  -1   Min.   :     0   Min.   :    0  
# 1st Qu.:  141.8   1st Qu.:     0   1st Qu.:843300   1st Qu.:172847   1st Qu.:   0   1st Qu.:  3562   1st Qu.: 2382  
# Median :  235.5   Median :  1400   Median :843300   Median :244572   Median :1024   Median :  4356   Median : 2870  
# Mean   :  312.4   Mean   : 13612   Mean   :752324   Mean   :259282   Mean   :1117   Mean   :  5657   Mean   : 3136  
# 3rd Qu.:  357.0   3rd Qu.:  7900   3rd Qu.:843300   3rd Qu.:330980   3rd Qu.:2057   3rd Qu.:  6020   3rd Qu.: 3600  
# Max.   :42827.9   Max.   :843300   Max.   :843300   Max.   :843300   Max.   :3613   Max.   :298400   Max.   :43568  
# 
# self_reference_min_shares self_reference_max_shares self_reference_avg_sharess weekday_is_monday weekday_is_tuesday
# Min.   :     0            Min.   :     0            Min.   :     0.0           Min.   :0.000     Min.   :0.0000    
# 1st Qu.:   639            1st Qu.:  1100            1st Qu.:   981.2           1st Qu.:0.000     1st Qu.:0.0000    
# Median :  1200            Median :  2800            Median :  2200.0           Median :0.000     Median :0.0000    
# Mean   :  3999            Mean   : 10329            Mean   :  6401.7           Mean   :0.168     Mean   :0.1864    
# 3rd Qu.:  2600            3rd Qu.:  8000            3rd Qu.:  5200.0           3rd Qu.:0.000     3rd Qu.:0.0000    
# Max.   :843300            Max.   :843300            Max.   :843300.0           Max.   :1.000     Max.   :1.0000    
# 
# weekday_is_wednesday weekday_is_thursday weekday_is_friday weekday_is_saturday weekday_is_sunday   is_weekend    
# Min.   :0.0000       Min.   :0.0000      Min.   :0.0000    Min.   :0.00000     Min.   :0.00000   Min.   :0.0000  
# 1st Qu.:0.0000       1st Qu.:0.0000      1st Qu.:0.0000    1st Qu.:0.00000     1st Qu.:0.00000   1st Qu.:0.0000  
# Median :0.0000       Median :0.0000      Median :0.0000    Median :0.00000     Median :0.00000   Median :0.0000  
# Mean   :0.1875       Mean   :0.1833      Mean   :0.1438    Mean   :0.06188     Mean   :0.06904   Mean   :0.1309  
# 3rd Qu.:0.0000       3rd Qu.:0.0000      3rd Qu.:0.0000    3rd Qu.:0.00000     3rd Qu.:0.00000   3rd Qu.:0.0000  
# Max.   :1.0000       Max.   :1.0000      Max.   :1.0000    Max.   :1.00000     Max.   :1.00000   Max.   :1.0000  
# 
# LDA_00            LDA_01            LDA_02            LDA_03            LDA_04        global_subjectivity
# Min.   :0.00000   Min.   :0.00000   Min.   :0.00000   Min.   :0.00000   Min.   :0.00000   Min.   :0.0000     
# 1st Qu.:0.02505   1st Qu.:0.02501   1st Qu.:0.02857   1st Qu.:0.02857   1st Qu.:0.02857   1st Qu.:0.3962     
# Median :0.03339   Median :0.03334   Median :0.04000   Median :0.04000   Median :0.04073   Median :0.4535     
# Mean   :0.18460   Mean   :0.14126   Mean   :0.21632   Mean   :0.22377   Mean   :0.23403   Mean   :0.4434     
# 3rd Qu.:0.24096   3rd Qu.:0.15083   3rd Qu.:0.33422   3rd Qu.:0.37576   3rd Qu.:0.39999   3rd Qu.:0.5083     
# Max.   :0.92699   Max.   :0.92595   Max.   :0.92000   Max.   :0.92653   Max.   :0.92719   Max.   :1.0000     
# 
# global_sentiment_polarity global_rate_positive_words global_rate_negative_words rate_positive_words rate_negative_words
# Min.   :-0.39375          Min.   :0.00000            Min.   :0.000000           Min.   :0.0000      Min.   :0.0000     
# 1st Qu.: 0.05776          1st Qu.:0.02838            1st Qu.:0.009615           1st Qu.:0.6000      1st Qu.:0.1852     
# Median : 0.11912          Median :0.03902            Median :0.015337           Median :0.7105      Median :0.2800     
# Mean   : 0.11931          Mean   :0.03962            Mean   :0.016612           Mean   :0.6822      Mean   :0.2879     
# 3rd Qu.: 0.17783          3rd Qu.:0.05028            3rd Qu.:0.021739           3rd Qu.:0.8000      3rd Qu.:0.3846     
# Max.   : 0.72784          Max.   :0.15549            Max.   :0.184932           Max.   :1.0000      Max.   :1.0000     
# 
# avg_positive_polarity min_positive_polarity max_positive_polarity avg_negative_polarity min_negative_polarity
# Min.   :0.0000        Min.   :0.00000       Min.   :0.0000        Min.   :-1.0000       Min.   :-1.0000      
# 1st Qu.:0.3062        1st Qu.:0.05000       1st Qu.:0.6000        1st Qu.:-0.3284       1st Qu.:-0.7000      
# Median :0.3588        Median :0.10000       Median :0.8000        Median :-0.2533       Median :-0.5000      
# Mean   :0.3538        Mean   :0.09545       Mean   :0.7567        Mean   :-0.2595       Mean   :-0.5219      
# 3rd Qu.:0.4114        3rd Qu.:0.10000       3rd Qu.:1.0000        3rd Qu.:-0.1869       3rd Qu.:-0.3000      
# Max.   :1.0000        Max.   :1.00000       Max.   :1.0000        Max.   : 0.0000       Max.   : 0.0000      
# 
# max_negative_polarity title_subjectivity title_sentiment_polarity abs_title_subjectivity abs_title_sentiment_polarity
# Min.   :-1.0000       Min.   :0.0000     Min.   :-1.00000         Min.   :0.0000         Min.   :0.0000              
# 1st Qu.:-0.1250       1st Qu.:0.0000     1st Qu.: 0.00000         1st Qu.:0.1667         1st Qu.:0.0000              
# Median :-0.1000       Median :0.1500     Median : 0.00000         Median :0.5000         Median :0.0000              
# Mean   :-0.1075       Mean   :0.2824     Mean   : 0.07143         Mean   :0.3418         Mean   :0.1561              
# 3rd Qu.:-0.0500       3rd Qu.:0.5000     3rd Qu.: 0.15000         3rd Qu.:0.5000         3rd Qu.:0.2500              
# Max.   : 0.0000       Max.   :1.0000     Max.   : 1.00000         Max.   :0.5000         Max.   :1.0000              
# 
# shares      
# Min.   :     1  
# 1st Qu.:   946  
# Median :  1400  
# Mean   :  3395  
# 3rd Qu.:  2800  
# Max.   :843300  


#==============================================================================================================

library(caret)


#=========================Pre-Process the data with Standardize Method=========================# 

# calculate the pre-process parameters from the dataset
preprocessParams <- preProcess(OnlineNewsPopularity, method=c("center", "scale"))
# summarize transform parameters
print(preprocessParams)
# 
# Created from 39644 samples and 61 variables
# 
# Pre-processing:
#   - centered (60)
# - ignored (1)
# - scaled (60)

# transform the dataset using the parameters
transformed <- predict(preprocessParams, OnlineNewsPopularity)
# summarize the transformed dataset

summary(transformed)

# url          timedelta        n_tokens_title   
# http://mashable.com/2013/01/07/amazon-instant-video-browser/  :    1   Min.   :-1.61806   Min.   :-3.9728  
# http://mashable.com/2013/01/07/ap-samsung-sponsored-tweets/   :    1   1st Qu.:-0.88965   1st Qu.:-0.6616  
# http://mashable.com/2013/01/07/apple-40-billion-app-downloads/:    1   Median :-0.07252   Median :-0.1886  
# http://mashable.com/2013/01/07/astronaut-notre-dame-bcs/      :    1   Mean   : 0.00000   Mean   : 0.0000  
# http://mashable.com/2013/01/07/att-u-verse-apps/              :    1   3rd Qu.: 0.87536   3rd Qu.: 0.7574  
# http://mashable.com/2013/01/07/beewi-smart-toys/              :    1   Max.   : 1.75786   Max.   : 5.9608  
# (Other)                                                       :39638                                       
# n_tokens_content  n_unique_tokens     n_non_stop_words    n_non_stop_unique_tokens   num_hrefs       num_self_hrefs    
# Min.   :-1.1601   Min.   : -0.15571   Min.   : -0.19048   Min.   : -0.21109        Min.   :-0.9604   Min.   :-0.85435  
# 1st Qu.:-0.6379   1st Qu.: -0.02197   1st Qu.:  0.00068   1st Qu.: -0.01943        1st Qu.:-0.6075   1st Qu.:-0.59496  
# Median :-0.2919   Median : -0.00255   Median :  0.00068   Median :  0.00040        Median :-0.2545   Median :-0.07617  
# Mean   : 0.0000   Mean   :  0.00000   Mean   :  0.00000   Mean   :  0.00000        Mean   : 0.0000   Mean   : 0.00000  
# 3rd Qu.: 0.3598   3rd Qu.:  0.01718   3rd Qu.:  0.00068   3rd Qu.:  0.02005        3rd Qu.: 0.2750   3rd Qu.: 0.18323  
# Max.   :16.8273   Max.   :198.95195   Max.   :198.99782   Max.   :198.88127        Max.   :25.8662   Max.   :29.23534  
# 
# num_imgs          num_videos       average_token_length  num_keywords     data_channel_is_lifestyle
# Min.   :-0.54687   Min.   :-0.30426   Min.   :-5.3863      Min.   :-3.2600   Min.   :-0.2364          
# 1st Qu.:-0.42652   1st Qu.:-0.30426   1st Qu.:-0.0827      1st Qu.:-0.6410   1st Qu.:-0.2364          
# Median :-0.42652   Median :-0.30426   Median : 0.1372      Median :-0.1172   Median :-0.2364          
# Mean   : 0.00000   Mean   : 0.00000   Mean   : 0.0000      Mean   : 0.0000   Mean   : 0.0000          
# 3rd Qu.:-0.06549   3rd Qu.:-0.06083   3rd Qu.: 0.3631      3rd Qu.: 0.9304   3rd Qu.:-0.2364          
# Max.   :14.85731   Max.   :21.84842   Max.   : 4.1370      Max.   : 1.4542   Max.   : 4.2293          
# 
# data_channel_is_entertainment data_channel_is_bus data_channel_is_socmed data_channel_is_tech data_channel_is_world
# Min.   :-0.4654               Min.   :-0.4329     Min.   :-0.2495        Min.   :-0.4769      Min.   :-0.5196      
# 1st Qu.:-0.4654               1st Qu.:-0.4329     1st Qu.:-0.2495        1st Qu.:-0.4769      1st Qu.:-0.5196      
# Median :-0.4654               Median :-0.4329     Median :-0.2495        Median :-0.4769      Median :-0.5196      
# Mean   : 0.0000               Mean   : 0.0000     Mean   : 0.0000        Mean   : 0.0000      Mean   : 0.0000      
# 3rd Qu.:-0.4654               3rd Qu.:-0.4329     3rd Qu.:-0.2495        3rd Qu.:-0.4769      3rd Qu.:-0.5196      
# Max.   : 2.1489               Max.   : 2.3097     Max.   : 4.0082        Max.   : 2.0968      Max.   : 1.9247      
# 
# kw_min_min        kw_max_min        kw_avg_min        kw_min_max         kw_max_max        kw_avg_max     
# Min.   :-0.3893   Min.   :-0.2991   Min.   :-0.5048   Min.   :-0.23475   Min.   :-3.5073   Min.   :-1.9192  
# 1st Qu.:-0.3893   1st Qu.:-0.1838   1st Qu.:-0.2748   1st Qu.:-0.23475   1st Qu.: 0.4241   1st Qu.:-0.6398  
# Median :-0.3893   Median :-0.1280   Median :-0.1238   Median :-0.21061   Median : 0.4241   Median :-0.1089  
# Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.00000   Mean   : 0.0000   Mean   : 0.0000  
# 3rd Qu.:-0.3175   3rd Qu.:-0.0399   3rd Qu.: 0.0719   3rd Qu.:-0.09851   3rd Qu.: 0.4241   3rd Qu.: 0.5307  
# Max.   : 5.0392   Max.   :77.0469   Max.   :68.4868   Max.   :14.30841   Max.   : 0.4241   Max.   : 4.3228  
# 
# kw_min_avg         kw_max_avg         kw_avg_avg      self_reference_min_shares self_reference_max_shares
# Min.   :-0.98302   Min.   :-0.92758   Min.   :-2.3790   Min.   :-0.20258          Min.   :-0.25176         
# 1st Qu.:-0.98214   1st Qu.:-0.34352   1st Qu.:-0.5716   1st Qu.:-0.17021          1st Qu.:-0.22495         
# Median :-0.08221   Median :-0.21340   Median :-0.2016   Median :-0.14179          Median :-0.18352         
# Mean   : 0.00000   Mean   : 0.00000   Mean   : 0.0000   Mean   : 0.00000          Mean   : 0.00000         
# 3rd Qu.: 0.82608   3rd Qu.: 0.05948   3rd Qu.: 0.3523   3rd Qu.:-0.07086          3rd Qu.:-0.05677         
# Max.   : 2.19427   Max.   :47.99950   Max.   :30.6731   Max.   :42.52066          Max.   :20.30270         
# 
# self_reference_avg_sharess weekday_is_monday weekday_is_tuesday weekday_is_wednesday weekday_is_thursday
# Min.   :-0.26441           Min.   :-0.4494   Min.   :-0.4787    Min.   :-0.4804      Min.   :-0.4738    
# 1st Qu.:-0.22388           1st Qu.:-0.4494   1st Qu.:-0.4787    1st Qu.:-0.4804      1st Qu.:-0.4738    
# Median :-0.17354           Median :-0.4494   Median :-0.4787    Median :-0.4804      Median :-0.4738    
# Mean   : 0.00000           Mean   : 0.0000   Mean   : 0.0000    Mean   : 0.0000      Mean   : 0.0000    
# 3rd Qu.:-0.04963           3rd Qu.:-0.4494   3rd Qu.:-0.4787    3rd Qu.:-0.4804      3rd Qu.:-0.4738    
# Max.   :34.56639           Max.   : 2.2252   Max.   : 2.0891    Max.   : 2.0813      Max.   : 2.1107    
# 
# weekday_is_friday weekday_is_saturday weekday_is_sunday   is_weekend          LDA_00            LDA_01        
# Min.   :-0.4098   Min.   :-0.2568     Min.   :-0.2723   Min.   :-0.3881   Min.   :-0.7020   Min.   :-0.64293  
# 1st Qu.:-0.4098   1st Qu.:-0.2568     1st Qu.:-0.2723   1st Qu.:-0.3881   1st Qu.:-0.6067   1st Qu.:-0.52908  
# Median :-0.4098   Median :-0.2568     Median :-0.2723   Median :-0.3881   Median :-0.5750   Median :-0.49116  
# Mean   : 0.0000   Mean   : 0.0000     Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.00000  
# 3rd Qu.:-0.4098   3rd Qu.:-0.2568     3rd Qu.:-0.2723   3rd Qu.:-0.3881   3rd Qu.: 0.2143   3rd Qu.: 0.04358  
# Max.   : 2.4400   Max.   : 3.8937     Max.   : 3.6721   Max.   : 2.5765   Max.   : 2.8231   Max.   : 3.57153  
# 
# LDA_02            LDA_03            LDA_04        global_subjectivity global_sentiment_polarity
# Min.   :-0.7667   Min.   :-0.7581   Min.   :-0.8093   Min.   :-3.79973    Min.   :-5.293054        
# 1st Qu.:-0.6654   1st Qu.:-0.6613   1st Qu.:-0.7105   1st Qu.:-0.40454    1st Qu.:-0.635010        
# Median :-0.6249   Median :-0.6225   Median :-0.6684   Median : 0.08645    Median :-0.001986        
# Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.00000    Mean   : 0.000000        
# 3rd Qu.: 0.4179   3rd Qu.: 0.5149   3rd Qu.: 0.5739   3rd Qu.: 0.55674    3rd Qu.: 0.603761        
# Max.   : 2.4940   Max.   : 2.3807   Max.   : 2.3970   Max.   : 4.77038    Max.   : 6.278010        
# 
# global_rate_positive_words global_rate_negative_words rate_positive_words rate_negative_words avg_positive_polarity
# Min.   :-2.27354           Min.   :-1.5342            Min.   :-3.5864     Min.   :-1.84388    Min.   :-3.38452     
# 1st Qu.:-0.64495           1st Qu.:-0.6462            1st Qu.:-0.4319     1st Qu.:-0.65799    1st Qu.:-0.45514     
# Median :-0.03454           Median :-0.1177            Median : 0.1492     Median :-0.05081    Median : 0.04716     
# Mean   : 0.00000           Mean   : 0.0000            Mean   : 0.0000     Mean   : 0.00000    Mean   : 0.00000     
# 3rd Qu.: 0.61132           3rd Qu.: 0.4735            3rd Qu.: 0.6196     3rd Qu.: 0.61914    3rd Qu.: 0.55100     
# Max.   : 6.64784           Max.   :15.5451            Max.   : 1.6711     Max.   : 4.55997    Max.   : 6.18100     
# 
# min_positive_polarity max_positive_polarity avg_negative_polarity min_negative_polarity max_negative_polarity
# Min.   :-1.33837      Min.   :-3.0540       Min.   :-5.79739      Min.   :-1.64683      Min.   :-9.35799     
# 1st Qu.:-0.63725      1st Qu.:-0.6325       1st Qu.:-0.53911      1st Qu.:-0.61337      1st Qu.:-0.18349     
# Median : 0.06386      Median : 0.1746       Median : 0.04847      Median : 0.07559      Median : 0.07864     
# Mean   : 0.00000      Mean   : 0.0000       Mean   : 0.00000      Mean   : 0.00000      Mean   : 0.00000     
# 3rd Qu.: 0.06386      3rd Qu.: 0.9818       3rd Qu.: 0.56856      3rd Qu.: 0.76456      3rd Qu.: 0.60290     
# Max.   :12.68394      Max.   : 0.9818       Max.   : 2.03189      Max.   : 1.79801      Max.   : 1.12716     
# 
# title_subjectivity title_sentiment_polarity abs_title_subjectivity abs_title_sentiment_polarity     shares        
# Min.   :-0.8708    Min.   :-4.0363          Min.   :-1.8107        Min.   :-0.6896              Min.   :-0.29194  
# 1st Qu.:-0.8708    1st Qu.:-0.2691          1st Qu.:-0.9279        1st Qu.:-0.6896              1st Qu.:-0.21066  
# Median :-0.4082    Median :-0.2691          Median : 0.8377        Median :-0.6896              Median :-0.17162  
# Mean   : 0.0000    Mean   : 0.0000          Mean   : 0.0000        Mean   : 0.0000              Mean   : 0.00000  
# 3rd Qu.: 0.6712    3rd Qu.: 0.2960          3rd Qu.: 0.8377        3rd Qu.: 0.4151              3rd Qu.:-0.05121  
# Max.   : 2.2133    Max.   : 3.4981          Max.   : 0.8377        Max.   : 3.7294              Max.   :72.23774 

######## In Data Pre Processing by standarized method i.e by scale and center method out of we process 39644 samples and 61 variables

#==============================================================================================================
##Cleaning Data & Fitting the linear Model##
#==============================================================================================================

colnames(OnlineNewsPopularity)

#drops = c("url","timedelta","is_weekend","kw_min_min", "kw_avg_min", "kw_min_avg","LDA_00","LDA_01","LDA_02","LDA_03","LDA_04")

# Removing the un necessary columns which are not effective in Analysis 
my_vars <- c("n_tokens_title", "n_tokens_content", "n_unique_tokens", "n_non_stop_words", "n_non_stop_unique_tokens", "num_hrefs",
             "num_self_hrefs", "num_imgs", "num_videos", "average_token_length", "num_keywords", "data_channel_is_lifestyle",
             "data_channel_is_entertainment", "data_channel_is_bus", "data_channel_is_socmed", "data_channel_is_tech",
             "data_channel_is_world", "kw_max_min", "kw_min_max", "kw_max_max", "kw_avg_max", 
             "kw_max_avg", "kw_avg_avg", "self_reference_min_shares", "self_reference_max_shares", "self_reference_avg_sharess",
             "weekday_is_monday", "weekday_is_tuesday", "weekday_is_wednesday", "weekday_is_thursday", "weekday_is_friday", "weekday_is_saturday",
             "weekday_is_sunday", "global_subjectivity", "global_sentiment_polarity", "global_rate_positive_words", "global_rate_negative_words",
             "rate_positive_words", "rate_negative_words", "avg_positive_polarity", "min_positive_polarity", "max_positive_polarity",
             "avg_negative_polarity", "min_negative_polarity", "max_negative_polarity", "title_subjectivity", "title_sentiment_polarity",
             "abs_title_subjectivity", "abs_title_sentiment_polarity", "shares")

# New data frame containing my_vars only
clean_df <- OnlineNewsPopularity[, (names(OnlineNewsPopularity) %in% my_vars)]

dim(clean_df)
#[1] 39644    50
# 
# we need to apply some kind of transformation to obtain values that are closer to normal distribution.
# Then we calculate the natural logarithm of shares and accordingly will predict the log_shares.
#

clean_df$shares <- log(clean_df$shares)
str(clean_df)
# 'data.frame':	39644 obs. of  50 variables:
#   $ n_tokens_title               : num  12 9 9 9 13 10 8 12 11 10 ...
# $ n_tokens_content             : num  219 255 211 531 1072 ...
# $ n_unique_tokens              : num  0.664 0.605 0.575 0.504 0.416 ...
# $ n_non_stop_words             : num  1 1 1 1 1 ...
# $ n_non_stop_unique_tokens     : num  0.815 0.792 0.664 0.666 0.541 ...
# $ num_hrefs                    : num  4 3 3 9 19 2 21 20 2 4 ...
# $ num_self_hrefs               : num  2 1 1 0 19 2 20 20 0 1 ...
# $ num_imgs                     : num  1 1 1 1 20 0 20 20 0 1 ...
# $ num_videos                   : num  0 0 0 0 0 0 0 0 0 1 ...
# $ average_token_length         : num  4.68 4.91 4.39 4.4 4.68 ...
# $ num_keywords                 : num  5 4 6 7 7 9 10 9 7 5 ...
# $ data_channel_is_lifestyle    : num  0 0 0 0 0 0 1 0 0 0 ...
# $ data_channel_is_entertainment: num  1 0 0 1 0 0 0 0 0 0 ...
# $ data_channel_is_bus          : num  0 1 1 0 0 0 0 0 0 0 ...
# $ data_channel_is_socmed       : num  0 0 0 0 0 0 0 0 0 0 ...
# $ data_channel_is_tech         : num  0 0 0 0 1 1 0 1 1 0 ...
# $ data_channel_is_world        : num  0 0 0 0 0 0 0 0 0 1 ...
# $ kw_max_min                   : num  0 0 0 0 0 0 0 0 0 0 ...
# $ kw_min_max                   : num  0 0 0 0 0 0 0 0 0 0 ...
# $ kw_max_max                   : num  0 0 0 0 0 0 0 0 0 0 ...
# $ kw_avg_max                   : num  0 0 0 0 0 0 0 0 0 0 ...
# $ kw_max_avg                   : num  0 0 0 0 0 0 0 0 0 0 ...
# $ kw_avg_avg                   : num  0 0 0 0 0 0 0 0 0 0 ...
# $ self_reference_min_shares    : num  496 0 918 0 545 8500 545 545 0 0 ...
# $ self_reference_max_shares    : num  496 0 918 0 16000 8500 16000 16000 0 0 ...
# $ self_reference_avg_sharess   : num  496 0 918 0 3151 ...
# $ weekday_is_monday            : num  1 1 1 1 1 1 1 1 1 1 ...
# $ weekday_is_tuesday           : num  0 0 0 0 0 0 0 0 0 0 ...
# $ weekday_is_wednesday         : num  0 0 0 0 0 0 0 0 0 0 ...
# $ weekday_is_thursday          : num  0 0 0 0 0 0 0 0 0 0 ...
# $ weekday_is_friday            : num  0 0 0 0 0 0 0 0 0 0 ...
# $ weekday_is_saturday          : num  0 0 0 0 0 0 0 0 0 0 ...
# $ weekday_is_sunday            : num  0 0 0 0 0 0 0 0 0 0 ...
# $ global_subjectivity          : num  0.522 0.341 0.702 0.43 0.514 ...
# $ global_sentiment_polarity    : num  0.0926 0.1489 0.3233 0.1007 0.281 ...
# $ global_rate_positive_words   : num  0.0457 0.0431 0.0569 0.0414 0.0746 ...
# $ global_rate_negative_words   : num  0.0137 0.01569 0.00948 0.02072 0.01213 ...
# $ rate_positive_words          : num  0.769 0.733 0.857 0.667 0.86 ...
# $ rate_negative_words          : num  0.231 0.267 0.143 0.333 0.14 ...
# $ avg_positive_polarity        : num  0.379 0.287 0.496 0.386 0.411 ...
# $ min_positive_polarity        : num  0.1 0.0333 0.1 0.1364 0.0333 ...
# $ max_positive_polarity        : num  0.7 0.7 1 0.8 1 0.6 1 1 0.8 0.5 ...
# $ avg_negative_polarity        : num  -0.35 -0.119 -0.467 -0.37 -0.22 ...
# $ min_negative_polarity        : num  -0.6 -0.125 -0.8 -0.6 -0.5 -0.4 -0.5 -0.5 -0.125 -0.5 ...
# $ max_negative_polarity        : num  -0.2 -0.1 -0.133 -0.167 -0.05 ...
# $ title_subjectivity           : num  0.5 0 0 0 0.455 ...
# $ title_sentiment_polarity     : num  -0.188 0 0 0 0.136 ...
# $ abs_title_subjectivity       : num  0 0.5 0.5 0.5 0.0455 ...
# $ abs_title_sentiment_polarity : num  0.188 0 0 0 0.136 ...
# $ shares                       : num  6.39 6.57 7.31 7.09 6.22 ...


#Variables which take values either 0 or 1 do not suffer of the last transformation, but we need to convert them to categorical.

clean_df$weekday_is_monday <- factor(clean_df$weekday_is_monday) 
clean_df$weekday_is_wednesday <- factor(clean_df$weekday_is_wednesday) 
clean_df$weekday_is_thursday <- factor(clean_df$weekday_is_thursday) 
clean_df$weekday_is_friday <- factor(clean_df$weekday_is_friday) 
clean_df$weekday_is_tuesday <- factor(clean_df$weekday_is_tuesday) 
clean_df$weekday_is_saturday <- factor(clean_df$weekday_is_saturday) 
clean_df$weekday_is_sunday <- factor(clean_df$weekday_is_sunday) 

clean_df$data_channel_is_lifestyle <- factor(clean_df$data_channel_is_lifestyle) 
clean_df$data_channel_is_entertainment <- factor(clean_df$data_channel_is_entertainment) 
clean_df$data_channel_is_bus <- factor(clean_df$data_channel_is_bus) 
clean_df$data_channel_is_socmed <- factor(clean_df$data_channel_is_socmed) 
clean_df$data_channel_is_tech <- factor(clean_df$data_channel_is_tech) 
clean_df$data_channel_is_world <- factor(clean_df$data_channel_is_world)

library(caret)

# random sampling
set.seed(1234)
inTrain = createDataPartition(y = clean_df$shares, p=0.7, list = FALSE)

# training dataset
train_df = clean_df[inTrain, ]
# validation dataset
val_df = clean_df[-inTrain, ]

sapply(train_df,class) 
# n_tokens_title              n_tokens_content               n_unique_tokens              n_non_stop_words 
# "numeric"                     "numeric"                     "numeric"                     "numeric" 
# n_non_stop_unique_tokens                     num_hrefs                num_self_hrefs                      num_imgs 
# "numeric"                     "numeric"                     "numeric"                     "numeric" 
# num_videos          average_token_length                  num_keywords     data_channel_is_lifestyle 
# "numeric"                     "numeric"                     "numeric"                      "factor" 
# data_channel_is_entertainment           data_channel_is_bus        data_channel_is_socmed          data_channel_is_tech 
# "factor"                      "factor"                      "factor"                      "factor" 
# data_channel_is_world                    kw_max_min                    kw_min_max                    kw_max_max 
# "factor"                     "numeric"                     "numeric"                     "numeric" 
# kw_avg_max                    kw_max_avg                    kw_avg_avg     self_reference_min_shares 
# "numeric"                     "numeric"                     "numeric"                     "numeric" 
# self_reference_max_shares    self_reference_avg_sharess             weekday_is_monday            weekday_is_tuesday 
# "numeric"                     "numeric"                      "factor"                      "factor" 
# weekday_is_wednesday           weekday_is_thursday             weekday_is_friday           weekday_is_saturday 
# "factor"                      "factor"                      "factor"                      "factor" 
# weekday_is_sunday           global_subjectivity     global_sentiment_polarity    global_rate_positive_words 
# "factor"                     "numeric"                     "numeric"                     "numeric" 
# global_rate_negative_words           rate_positive_words           rate_negative_words         avg_positive_polarity 
# "numeric"                     "numeric"                     "numeric"                     "numeric" 
# min_positive_polarity         max_positive_polarity         avg_negative_polarity         min_negative_polarity 
# "numeric"                     "numeric"                     "numeric"                     "numeric" 
# max_negative_polarity            title_subjectivity      title_sentiment_polarity        abs_title_subjectivity 
# "numeric"                     "numeric"                     "numeric"                     "numeric" 
# abs_title_sentiment_polarity                        shares 
# "numeric"                     "numeric" 


fit_full = lm(shares ~.,data = train_df)
summary(fit_full)

# Call:
#   lm(formula = shares ~ ., data = train_df)
# 
# Residuals:
#   Min      1Q  Median      3Q     Max 
# -8.0717 -0.5478 -0.1666  0.3943  5.9565 
# 
# Coefficients: (1 not defined because of singularities)
# Estimate Std. Error t value Pr(>|t|)    
# (Intercept)                     6.979e+00  6.437e-02 108.426  < 2e-16 ***
#   n_tokens_title                  8.441e-03  2.601e-03   3.246 0.001173 ** 
#   n_tokens_content                1.860e-05  2.051e-05   0.907 0.364415    
# n_unique_tokens                 3.611e-02  1.730e-01   0.209 0.834622    
# n_non_stop_words                6.587e-02  5.903e-02   1.116 0.264516    
# n_non_stop_unique_tokens       -1.418e-01  1.468e-01  -0.966 0.334114    
# num_hrefs                       4.440e-03  5.973e-04   7.433 1.09e-13 ***
#   num_self_hrefs                 -8.870e-03  1.647e-03  -5.384 7.35e-08 ***
#   num_imgs                        2.476e-03  8.078e-04   3.065 0.002181 ** 
#   num_videos                      1.032e-03  1.393e-03   0.741 0.458792    
# average_token_length           -8.324e-02  2.151e-02  -3.870 0.000109 ***
#   num_keywords                    2.075e-02  3.271e-03   6.344 2.27e-10 ***
#   data_channel_is_lifestyle1     -3.090e-02  2.934e-02  -1.053 0.292150    
# data_channel_is_entertainment1 -2.016e-01  2.185e-02  -9.228  < 2e-16 ***
#   data_channel_is_bus1            1.425e-02  2.362e-02   0.603 0.546336    
# data_channel_is_socmed1         2.318e-01  2.893e-02   8.011 1.18e-15 ***
#   data_channel_is_tech1           1.508e-01  2.334e-02   6.460 1.06e-10 ***
#   data_channel_is_world1         -1.431e-01  2.465e-02  -5.804 6.54e-09 ***
#   kw_max_min                     -3.820e-06  1.596e-06  -2.393 0.016700 *  
#   kw_min_max                     -5.165e-07  1.046e-07  -4.939 7.92e-07 ***
#   kw_max_max                     -2.090e-07  3.445e-08  -6.065 1.33e-09 ***
#   kw_avg_max                     -2.073e-07  7.197e-08  -2.880 0.003984 ** 
#   kw_max_avg                     -3.108e-05  1.877e-06 -16.560  < 2e-16 ***
#   kw_avg_avg                      2.691e-04  9.747e-06  27.607  < 2e-16 ***
#   self_reference_min_shares       3.955e-07  7.053e-07   0.561 0.574994    
# self_reference_max_shares      -2.037e-08  3.683e-07  -0.055 0.955892    
# self_reference_avg_sharess      1.590e-06  9.725e-07   1.635 0.101994    
# weekday_is_monday1             -2.126e-01  2.385e-02  -8.914  < 2e-16 ***
#   weekday_is_tuesday1            -2.714e-01  2.345e-02 -11.572  < 2e-16 ***
#   weekday_is_wednesday1          -2.719e-01  2.348e-02 -11.580  < 2e-16 ***
#   weekday_is_thursday1           -2.691e-01  2.350e-02 -11.451  < 2e-16 ***
#   weekday_is_friday1             -2.044e-01  2.433e-02  -8.400  < 2e-16 ***
#   weekday_is_saturday1            2.613e-02  2.907e-02   0.899 0.368578    
# weekday_is_sunday1                     NA         NA      NA       NA    
# global_subjectivity             4.549e-01  7.717e-02   5.896 3.77e-09 ***
#   global_sentiment_polarity      -1.855e-01  1.530e-01  -1.213 0.225268    
# global_rate_positive_words     -8.971e-01  6.470e-01  -1.387 0.165587    
# global_rate_negative_words      4.457e-01  1.226e+00   0.364 0.716194    
# rate_positive_words             2.424e-01  1.278e-01   1.897 0.057834 .  
# rate_negative_words             6.071e-02  1.448e-01   0.419 0.675020    
# avg_positive_polarity           9.969e-02  1.244e-01   0.801 0.423018    
# min_positive_polarity          -3.882e-01  1.042e-01  -3.724 0.000196 ***
#   max_positive_polarity          -5.501e-02  3.938e-02  -1.397 0.162442    
# avg_negative_polarity          -8.442e-02  1.142e-01  -0.739 0.459651    
# min_negative_polarity          -1.580e-02  4.161e-02  -0.380 0.704214    
# max_negative_polarity           9.572e-02  9.488e-02   1.009 0.313033    
# title_subjectivity              4.442e-02  2.476e-02   1.794 0.072855 .  
# title_sentiment_polarity        8.393e-02  2.273e-02   3.693 0.000222 ***
#   abs_title_subjectivity          1.485e-01  3.304e-02   4.495 7.00e-06 ***
#   abs_title_sentiment_polarity    5.017e-02  3.573e-02   1.404 0.160293    
# ---
#   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# 
# Residual standard error: 0.8734 on 27703 degrees of freedom
# Multiple R-squared:  0.1191,	Adjusted R-squared:  0.1176 
# F-statistic: 78.03 on 48 and 27703 DF,  p-value: < 2.2e-16



# RSME on validation dataset 
pred_full = predict(fit_full, val_df)
sqrt(mean((val_df$shares - pred_full)^2))
#[1] 0.8742265


# Full model has the residual standard error as 0.8703 on 20953 degrees of freedom. 
# And the Adjusted R-squared value is 0.1212, which means that the model can explain about 12% 
# of the variance of the log_shares.


